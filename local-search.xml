<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>PromiseA+规范</title>
    <link href="/2024/08/28/PromiseA+%E8%A7%84%E8%8C%83/"/>
    <url>/2024/08/28/PromiseA+%E8%A7%84%E8%8C%83/</url>
    
    <content type="html"><![CDATA[<h2 id="PromiseA-规范"><a href="#PromiseA-规范" class="headerlink" title="PromiseA+规范"></a>PromiseA+规范</h2><h3 id="1-术语"><a href="#1-术语" class="headerlink" title="1. 术语"></a>1. 术语</h3><ul><li>Promise 是一个拥有 <code>then</code> 方法的对象或函数，其行为符合本规范。</li><li>thenable 是定义了 <code>then</code> 方法的对象或函数。</li><li>value 是任何合法的 JavaScript 值（包括 undefined, thenable, 或 promise）。</li><li>exception 是一个使用 throw 语句抛出的值。</li><li>reason 是一个表明 promise 为什么被拒绝的值。</li></ul><h3 id="2-要求"><a href="#2-要求" class="headerlink" title="2. 要求"></a>2. 要求</h3><h4 id="2-1-Promise-状态"><a href="#2-1-Promise-状态" class="headerlink" title="2.1 Promise 状态"></a>2.1 Promise 状态</h4><p>一个 promise 必须处于以下三个状态之一：<code>pending</code>，<code>fulfilled</code>，或 <code>rejected</code>。</p><ul><li><p>当处于 pending 状态时，promise：</p><ul><li>可能会转变为 <code>fulfilled</code> 状态并传递一个值给相应的 <code>onFulfilled</code> 回调函数。</li><li>也可能会转变为 <code>rejected</code> 状态并传递一个值给相应的 <code>onRejected</code> 回调函数。</li></ul></li><li><p>当处于 <code>fulfilled</code> 状态时，promise：</p><ul><li>必须不会转变为其他任何状态。</li><li>必须有一个值，且这个值不能被改变。</li></ul></li><li><p>当处于 <code>rejected</code> 状态时，promise：</p><ul><li>必须不会转变为其他任何状态。</li><li>必须有一个值，且这个值不能被改变。</li></ul></li></ul><h4 id="2-2-then-方法"><a href="#2-2-then-方法" class="headerlink" title="2.2 then 方法"></a>2.2 then 方法</h4><p>一个 promise 必须提供一个 <code>then</code> 方法以访问其当前值、最终值或拒绝原因。</p><p>promise 的 then 方法接收两个参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">promise.<span class="hljs-title function_">then</span>(onFulfilled, onRejected);<br></code></pre></td></tr></table></figure><ul><li><p><code>onFulfilled</code> 和 <code>onRejected</code> 都是可选参数。</p><ul><li>如果 <code>onFulfilled</code> 不是函数，它必须被忽略。</li><li>如果 <code>onRejected</code> 不是函数，它必须被忽略。</li></ul></li><li><p>如果 <code>onFulfilled</code> 是一个函数：</p><ul><li>它必须在 promise 被 <code>fulfilled</code> 后调用，并且 promise 的值作为它的第一个参数。</li><li>它不能被调用超过一次。</li><li>它必须以函数的形式被调用（即没有 this 值）。</li></ul></li><li><p>如果 <code>onRejected</code> 是一个函数：</p><ul><li>它必须在 promise 被 <code>rejected</code> 后调用，并且 promise 的拒绝原因作为它的第一个参数。</li><li>它不能被调用超过一次。</li><li>它必须以函数的形式被调用（即没有 this 值）。</li></ul></li><li><p>then 方法必须返回一个 promise。</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">promise2 = promise1.<span class="hljs-title function_">then</span>(onFulfilled, onRejected);<br></code></pre></td></tr></table></figure><ul><li>如果 <code>onFulfilled</code> 或 <code>onRejected</code> 抛出一个异常 e，promise2 必须以 e 为拒绝原因被拒绝。</li><li>如果 <code>onFulfilled</code> 是一个函数且返回一个值 x，运行 [[PromiseResolve]](promise2, x)。</li><li>如果 <code>onRejected</code> 是一个函数且返回一个值 x，运行 [[PromiseResolve]](promise2, x)。</li><li>如果 <code>onFulfilled</code> 不是函数且 promise1 被 fulfilled，promise2 必须以与 promise1 相同的值被 <code>fulfilled</code>。</li><li>如果 <code>onRejected</code> 不是函数且 promise1 被 rejected，promise2 必须以与 promise1 相同的原因被 <code>rejected</code>。</li></ul><h4 id="2-3-Promise-解析过程"><a href="#2-3-Promise-解析过程" class="headerlink" title="2.3 Promise 解析过程"></a>2.3 Promise 解析过程</h4><p>[[PromiseResolve]](promise, x) 的执行过程如下：</p><ul><li>如果 promise 和 x 指向同一个对象，promise 必须以 TypeError 为拒绝原因被拒绝。</li><li>如果 x 是一个 thenable 对象，则尝试以 x 为基础执行，即尝试执行 x.then(resolvePromise, rejectPromise)：<ul><li>如果 resolvePromise 以值 y 为参数被调用，如果 y 不是 thenable，则用 y 作为 promise 的值，否则继续执行 [[PromiseResolve]](promise, y)。</li><li>如果 rejectPromise 以原因 r 为参数被调用，则以 r 为拒绝原因拒绝 promise。</li><li>如果 resolvePromise 和 rejectPromise 都被调用，或者被同一个参数调用多次，则第一次调用优先，后续调用都会被忽略。</li><li>如果调用 then 方法抛出异常 e，则：<ul><li>如果 resolvePromise 或 rejectPromise 已经被调用，则忽略这个异常。</li><li>否则，以 e 为拒绝原因拒绝 promise。</li></ul></li></ul></li><li>如果 x 不是 thenable 对象或函数，则用 x 作为 promise 的值，fulfill promise。</li><li>如果在尝试执行 x.then 时抛出异常 e，则：<ul><li>如果 resolvePromise 或 rejectPromise 已经被调用，则忽略这个异常。</li><li>否则，以 e 为拒绝原因拒绝 promise。</li></ul></li></ul><h3 id="3-注意事项"><a href="#3-注意事项" class="headerlink" title="3. 注意事项"></a>3. 注意事项</h3><ul><li>本规范没有定义 promise 的构造函数，也没有定义如何创建一个 promise。本规范假定 promise 的构造函数是 Promise，Promise 的构造函数是 Promise 构造器。</li><li>本规范假定 promise 的 then 方法是 Promise.prototype.then，then 方法是 then 方法。</li><li>本规范假定 promise 的 resolve 方法是 Promise.resolve，resolve 方法是 resolve 方法。</li><li>本规范假定 promise 的 reject 方法是 Promise.reject，reject 方法是 reject 方法。</li><li>本规范假定 promise 的 all 方法是 Promise.all，all 方法是 all 方法。</li><li>本规范假定 promise 的 race 方法是 Promise.race，race 方法是 race 方法。</li><li>本规范假定 promise 的 any 方法是 Promise.any，any 方法是 any 方法。</li><li>本规范假定 promise 的 allSettled 方法是 Promise.allSettled，allSettled 方法是 allSettled 方法。</li><li>本规范假定 promise 的 catch 方法是 Promise.prototype.catch，catch 方法是 catch 方法。</li><li>本规范假定 promise 的 finally 方法是 Promise.prototype.finally，finally 方法是 finally 方法。</li></ul><p>转载：<a href="https://promisesaplus.com/">https://promisesaplus.com/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>Promise</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React Diff算法</title>
    <link href="/2024/08/21/React%20Diff%E7%AE%97%E6%B3%95/"/>
    <url>/2024/08/21/React%20Diff%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="详解-React-diff"><a href="#详解-React-diff" class="headerlink" title="详解 React diff"></a>详解 React diff</h2><p>传统 diff 算法的复杂度为 O(n^3)，显然这是无法满足性能要求的。React 通过制定大胆的策略，将 O(n^3) 复杂度的问题转换成 O(n) 复杂度的问题。</p><h3 id="diff-策略"><a href="#diff-策略" class="headerlink" title="diff 策略"></a>diff 策略</h3><p>Web UI 中 DOM 节点跨层级的移动操作特别少，可以忽略不计。拥有相同类的两个组件将会生成相似的树形结构，拥有不同类的两个组件将会生成不同的树形结构。对于同一层级的一组子节点，它们可以通过唯一 id 进行区分。基于以上三个前提策略，React 分别对 tree diff、component diff 以及 element diff 进行算法优化，事实也证明这三个前提策略是合理且准确的，它保证了整体界面构建的性能。</p><ul><li>tree diff</li><li>component diff</li><li>element diff</li></ul><h3 id="tree-diff"><a href="#tree-diff" class="headerlink" title="tree diff"></a>tree diff</h3><p>基于策略一，React 对树的算法进行了简洁明了的优化，即对树进行分层比较，两棵树只会对同一层次的节点进行比较。既然 DOM 节点跨层级的移动操作少到可以忽略不计，针对这一现象，React 通过 updateDepth 对 Virtual DOM 树进行层级控制，只会对相同颜色方框内的 DOM 节点进行比较，即同一个父节点下的所有子节点。当发现节点已经不存在，则该节点及其子节点会被完全删除掉，不会用于进一步的比较。这样只需要对树进行一次遍历，便能完成整个 DOM 树的比较。</p><img src="https://cdn.houdemingxin.com/image/default/316C9ED905684883A41F67CCF68036E6-6-2.png" style="width: 100%;" /><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">updateChildren</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">nextNestedChildrenElements, transaction, context</span>) &#123;<br>  updateDepth++;<br>  <span class="hljs-keyword">var</span> errorThrown = <span class="hljs-literal">true</span>;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_updateChildren</span>(nextNestedChildrenElements, transaction, context);<br>    errorThrown = <span class="hljs-literal">false</span>;<br>  &#125; <span class="hljs-keyword">finally</span> &#123;<br>    updateDepth--;<br>    <span class="hljs-keyword">if</span> (!updateDepth) &#123;<br>      <span class="hljs-keyword">if</span> (errorThrown) &#123;<br>        <span class="hljs-title function_">clearQueue</span>();<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_">processQueue</span>();<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>分析至此，大部分人可能都存在这样的疑问：如果出现了 DOM 节点跨层级的移动操作，React diff 会有怎样的表现呢？是的，对此我也好奇不已，不如试验一番。如下图，A 节点（包括其子节点）整个被移动到 D 节点下，由于 React 只会简单的考虑同层级节点的位置变换，而对于不同层级的节点，只有创建和删除操作。当根节点发现子节点中 A 消失了，就会直接销毁 A；当 D 发现多了一个子节点 A，则会创建新的 A（包括子节点）作为其子节点。此时，React diff 的执行情况：create A -&gt; create B -&gt; create C -&gt; delete A。由此可发现，当出现节点跨层级移动时，并不会出现想象中的移动操作，而是以 A 为根节点的树被整个重新创建，这是一种影响 React 性能的操作，因此 React 官方建议不要进行 DOM 节点跨层级的操作。注意：在开发组件时，保持稳定的 DOM 结构会有助于性能的提升。例如，可以通过 CSS 隐藏或显示节点，而不是真的移除或添加 DOM 节点。</p><img src="https://cdn.houdemingxin.com/image/default/5A9F613F90004178B48A3F37A9AED36E-6-2.png" style="width: 100%;" /><h3 id="component-diff"><a href="#component-diff" class="headerlink" title="component diff"></a>component diff</h3><p>React 是基于组件构建应用的，对于组件间的比较所采取的策略也是简洁高效。</p><ul><li><p>如果是同一类型的组件，按照原策略继续比较 virtual DOM tree。</p></li><li><p>如果不是，则将该组件判断为 dirty component，从而替换整个组件下的所有子节点。</p></li><li><p>对于同一类型的组件，有可能其 Virtual DOM 没有任何变化，如果能够确切的知道这点那可以节省大量的 diff 运算时间，因此 React 允许用户通过 shouldComponentUpdate() 来判断该组件是否需要进行 diff。</p></li></ul><p>如下图，当 component D 改变为 component G 时，即使这两个 component 结构相似，一旦 React 判断 D 和 G 是不同类型的组件，就不会比较二者的结构，而是直接删除 component D，重新创建 component G 以及其子节点。虽然当两个 component 是不同类型但结构相似时，React diff 会影响性能，但正如 React 官方博客所言：不同类型的 component 是很少存在相似 DOM tree 的机会，因此这种极端因素很难在实现开发过程中造成重大影响的。</p><img src="https://cdn.houdemingxin.com/image/default/5D47E948371E474D9FB047AFFC230205-6-2.png" style="width: 100%;" /><h3 id="element-diff"><a href="#element-diff" class="headerlink" title="element diff"></a>element diff</h3><p>当节点处于同一层级时，React diff 提供了三种节点操作，分别为：INSERT_MARKUP（插入）、MOVE_EXISTING（移动）和 REMOVE_NODE（删除）。</p><ul><li><p>INSERT_MARKUP：新的 component 类型不在老集合里， 即是全新的节点，需要对新节点执行插入操作。</p></li><li><p>MOVE_EXISTING：在老集合有新 component 类型，且 element 是可更新的类型，generateComponentChildren 已调用 receiveComponent，这种情况下 prevChild&#x3D;nextChild，就需要做移动操作，可以复用以前的 DOM 节点。</p></li><li><p>REMOVE_NODE： 老 component 类型，在新集合里也有，但对应的 element 不同则不能直接复用和更新，需要执行删除操作，或者老 component 不在新集合里的，也需要执行删除操作。</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">enqueueInsertMarkup</span>(<span class="hljs-params">parentInst, markup, toIndex</span>) &#123;<br>  updateQueue.<span class="hljs-title function_">push</span>(&#123;<br>    <span class="hljs-attr">parentInst</span>: parentInst,<br>    <span class="hljs-attr">parentNode</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">type</span>: <span class="hljs-title class_">ReactMultiChildUpdateTypes</span>.<span class="hljs-property">INSERT_MARKUP</span>,<br>    <span class="hljs-attr">markupIndex</span>: markupQueue.<span class="hljs-title function_">push</span>(markup) - <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">content</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">fromIndex</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">toIndex</span>: toIndex,<br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">enqueueMove</span>(<span class="hljs-params">parentInst, fromIndex, toIndex</span>) &#123;<br>  updateQueue.<span class="hljs-title function_">push</span>(&#123;<br>    <span class="hljs-attr">parentInst</span>: parentInst,<br>    <span class="hljs-attr">parentNode</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">type</span>: <span class="hljs-title class_">ReactMultiChildUpdateTypes</span>.<span class="hljs-property">MOVE_EXISTING</span>,<br>    <span class="hljs-attr">markupIndex</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">content</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">fromIndex</span>: fromIndex,<br>    <span class="hljs-attr">toIndex</span>: toIndex,<br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">enqueueRemove</span>(<span class="hljs-params">parentInst, fromIndex</span>) &#123;<br>  updateQueue.<span class="hljs-title function_">push</span>(&#123;<br>    <span class="hljs-attr">parentInst</span>: parentInst,<br>    <span class="hljs-attr">parentNode</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">type</span>: <span class="hljs-title class_">ReactMultiChildUpdateTypes</span>.<span class="hljs-property">REMOVE_NODE</span>,<br>    <span class="hljs-attr">markupIndex</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">content</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">fromIndex</span>: fromIndex,<br>    <span class="hljs-attr">toIndex</span>: <span class="hljs-literal">null</span>,<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>如下图，老集合中包含节点：A、B、C、D，更新后的新集合中包含节点：B、A、D、C，此时新老集合进行 diff 差异化对比，发现 B !&#x3D; A，则创建并插入 B 至新集合，删除老集合 A；以此类推，创建并插入 A、D 和 C，删除 B、C 和 D。</p><img src="https://cdn.houdemingxin.com/image/default/F1C4DC66270A4325AA4A6FDAF7A16284-6-2.png" style="width: 100%;" /><p>React 发现这类操作繁琐冗余，因为这些都是相同的节点，但由于位置发生变化，导致需要进行繁杂低效的删除、创建操作，其实只要对这些节点进行位置移动即可。</p><p>针对这一现象，React 提出优化策略：允许开发者对同一层级的同组子节点，添加唯一 key 进行区分，虽然只是小小的改动，性能上却发生了翻天覆地的变化！</p><p>新老集合所包含的节点，如下图所示，新老集合进行 diff 差异化对比，通过 key 发现新老集合中的节点都是相同的节点，因此无需进行节点删除和创建，只需要将老集合中节点的位置进行移动，更新为新集合中节点的位置，此时 React 给出的 diff 结果为：B、D 不做任何操作，A、C 进行移动操作，即可。</p><img src="https://cdn.houdemingxin.com/image/default/64D74AF0A27A455DA66C7DAF9C3D7317-6-2.png" style="width: 100%;" /><p>那么，如此高效的 diff 到底是如何运作的呢？让我们通过源码进行详细分析。</p><p>首先对新集合的节点进行循环遍历，for (name in nextChildren)，通过唯一 key 可以判断新老集合中是否存在相同的节点，if (prevChild &#x3D;&#x3D;&#x3D; nextChild)，如果存在相同节点，则进行移动操作，但在移动前需要将当前节点在老集合中的位置与 lastIndex 进行比较，if (child._mountIndex &lt; lastIndex)，则进行节点移动操作，否则不执行该操作。这是一种顺序优化手段，lastIndex 一直在更新，表示访问过的节点在老集合中最右的位置（即最大的位置），如果新集合中当前访问的节点比 lastIndex 大，说明当前访问节点在老集合中就比上一个节点位置靠后，则该节点不会影响其他节点的位置，因此不用添加到差异队列中，即不执行移动操作，只有当访问的节点比 lastIndex 小时，才需要进行移动操作。</p><p>以上图为例，可以更为清晰直观的描述 diff 的差异对比过程：</p><ul><li><p>从新集合中取得 B，判断老集合中存在相同节点 B，通过对比节点位置判断是否进行移动操作，B 在老集合中的位置 B._mountIndex &#x3D; 1，此时 lastIndex &#x3D; 0，不满足 child._mountIndex &lt; lastIndex 的条件，因此不对 B 进行移动操作；更新 lastIndex &#x3D; Math.max(prevChild._mountIndex, lastIndex)，其中 prevChild._mountIndex 表示 B 在老集合中的位置，则 lastIndex ＝ 1，并将 B 的位置更新为新集合中的位置 prevChild._mountIndex &#x3D; nextIndex，此时新集合中 B._mountIndex &#x3D; 0，nextIndex++ 进入下一个节点的判断。</p></li><li><p>从新集合中取得 A，判断老集合中存在相同节点 A，通过对比节点位置判断是否进行移动操作，A 在老集合中的位置 A._mountIndex &#x3D; 0，此时 lastIndex &#x3D; 1，满足 child._mountIndex &lt; lastIndex 的条件，因此对 A 进行移动操作 enqueueMove(this, child._mountIndex, toIndex)，其中 toIndex 其实就是 nextIndex，表示 A 需要移动到的位置；更新 lastIndex &#x3D; Math.max(prevChild._mountIndex, lastIndex)，则 lastIndex ＝ 1，并将 A 的位置更新为新集合中的位置 prevChild._mountIndex &#x3D; nextIndex，此时新集合中 A._mountIndex &#x3D; 1，nextIndex++ 进入下一个节点的判断。</p></li><li><p>从新集合中取得 D，判断老集合中存在相同节点 D，通过对比节点位置判断是否进行移动操作，D 在老集合中的位置 D._mountIndex &#x3D; 3，此时 lastIndex &#x3D; 1，不满足 child._mountIndex &lt; lastIndex 的条件，因此不对 D 进行移动操作；更新 lastIndex &#x3D; Math.max(prevChild._mountIndex, lastIndex)，则 lastIndex ＝ 3，并将 D 的位置更新为新集合中的位置 prevChild._mountIndex &#x3D; nextIndex，此时新集合中 D._mountIndex &#x3D; 2，nextIndex++ 进入下一个节点的判断。</p></li><li><p>从新集合中取得 C，判断老集合中存在相同节点 C，通过对比节点位置判断是否进行移动操作，C 在老集合中的位置 C._mountIndex &#x3D; 2，此时 lastIndex &#x3D; 3，满足 child._mountIndex &lt; lastIndex 的条件，因此对 C 进行移动操作 enqueueMove(this, child._mountIndex, toIndex)；更新 lastIndex &#x3D; Math.max(prevChild._mountIndex, lastIndex)，则 lastIndex ＝ 3，并将 C 的位置更新为新集合中的位置 prevChild._mountIndex &#x3D; nextIndex，此时新集合中 C._mountIndex &#x3D; 3，nextIndex++ 进入下一个节点的判断，由于 C 已经是最后一个节点，因此 diff 到此完成。</p></li></ul><p>以上主要分析新老集合中存在相同节点但位置不同时，对节点进行位置移动的情况，如果新集合中有新加入的节点且老集合存在需要删除的节点，那么 React diff 又是如何对比运作的呢？</p><p>以下图为例：</p><ul><li><p>从新集合中取得 B，判断老集合中存在相同节点 B，由于 B 在老集合中的位置 B._mountIndex &#x3D; 1，此时 lastIndex &#x3D; 0，因此不对 B 进行移动操作；更新 lastIndex ＝ 1，并将 B 的位置更新为新集合中的位置 B._mountIndex &#x3D; 0，nextIndex++进入下一个节点的判断。</p></li><li><p>从新集合中取得 E，判断老集合中不存在相同节点 E，则创建新节点 E；更新 lastIndex ＝ 1，并将 E 的位置更新为新集合中的位置，nextIndex++进入下一个节点的判断。</p></li><li><p>从新集合中取得 C，判断老集合中存在相同节点 C，由于 C 在老集合中的位置 C._mountIndex &#x3D; 2，lastIndex &#x3D; 1，此时 C._mountIndex &gt; lastIndex，因此不对 C 进行移动操作；更新 lastIndex ＝ 2，并将 C 的位置更新为新集合中的位置，nextIndex++ 进入下一个节点的判断。</p></li><li><p>从新集合中取得 A，判断老集合中存在相同节点 A，由于 A 在老集合中的位置 A._mountIndex &#x3D; 0，lastIndex &#x3D; 2，此时 A._mountIndex &lt; lastIndex，因此对 A 进行移动操作；更新 lastIndex ＝ 2，并将 A 的位置更新为新集合中的位置，nextIndex++ 进入下一个节点的判断。</p></li><li><p>当完成新集合中所有节点 diff 时，最后还需要对老集合进行循环遍历，判断是否存在新集合中没有但老集合中仍存在的节点，发现存在这样的节点 D，因此删除节点 D，到此 diff 全部完成。</p></li></ul><img src="https://cdn.houdemingxin.com/image/default/504D0FE4D63B4035969CC0190B28B3D9-6-2.png" style="width: 100%;" /><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">_updateChildren</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">nextNestedChildrenElements, transaction, context</span>) &#123;<br>  <span class="hljs-keyword">var</span> prevChildren = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_renderedChildren</span>;<br>  <span class="hljs-keyword">var</span> nextChildren = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_reconcilerUpdateChildren</span>(<br>    prevChildren, nextNestedChildrenElements, transaction, context<br>  );<br>  <span class="hljs-keyword">if</span> (!nextChildren &amp;&amp; !prevChildren) &#123;<br>    <span class="hljs-keyword">return</span>;<br>  &#125;<br>  <span class="hljs-keyword">var</span> name;<br>  <span class="hljs-keyword">var</span> lastIndex = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">var</span> nextIndex = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (name <span class="hljs-keyword">in</span> nextChildren) &#123;<br>    <span class="hljs-keyword">if</span> (!nextChildren.<span class="hljs-title function_">hasOwnProperty</span>(name)) &#123;<br>      <span class="hljs-keyword">continue</span>;<br>    &#125;<br>    <span class="hljs-keyword">var</span> prevChild = prevChildren &amp;&amp; prevChildren[name];<br>    <span class="hljs-keyword">var</span> nextChild = nextChildren[name];<br>    <span class="hljs-keyword">if</span> (prevChild === nextChild) &#123;<br>      <span class="hljs-comment">// 移动节点</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">moveChild</span>(prevChild, nextIndex, lastIndex);<br>      lastIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(prevChild.<span class="hljs-property">_mountIndex</span>, lastIndex);<br>      prevChild.<span class="hljs-property">_mountIndex</span> = nextIndex;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">if</span> (prevChild) &#123;<br>        lastIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(prevChild.<span class="hljs-property">_mountIndex</span>, lastIndex);<br>        <span class="hljs-comment">// 删除节点</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_unmountChild</span>(prevChild);<br>      &#125;<br>      <span class="hljs-comment">// 初始化并创建节点</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_mountChildAtIndex</span>(<br>        nextChild, nextIndex, transaction, context<br>      );<br>    &#125;<br>    nextIndex++;<br>  &#125;<br>  <span class="hljs-keyword">for</span> (name <span class="hljs-keyword">in</span> prevChildren) &#123;<br>    <span class="hljs-keyword">if</span> (prevChildren.<span class="hljs-title function_">hasOwnProperty</span>(name) &amp;&amp;<br>        !(nextChildren &amp;&amp; nextChildren.<span class="hljs-title function_">hasOwnProperty</span>(name))) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_unmountChild</span>(prevChildren[name]);<br>    &#125;<br>  &#125;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">_renderedChildren</span> = nextChildren;<br>&#125;,<br><span class="hljs-comment">// 移动节点</span><br><span class="hljs-attr">moveChild</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">child, toIndex, lastIndex</span>) &#123;<br>  <span class="hljs-keyword">if</span> (child.<span class="hljs-property">_mountIndex</span> &lt; lastIndex) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">prepareToManageChildren</span>();<br>    <span class="hljs-title function_">enqueueMove</span>(<span class="hljs-variable language_">this</span>, child.<span class="hljs-property">_mountIndex</span>, toIndex);<br>  &#125;<br>&#125;,<br><span class="hljs-comment">// 创建节点</span><br><span class="hljs-attr">createChild</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">child, mountImage</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">prepareToManageChildren</span>();<br>  <span class="hljs-title function_">enqueueInsertMarkup</span>(<span class="hljs-variable language_">this</span>, mountImage, child.<span class="hljs-property">_mountIndex</span>);<br>&#125;,<br><span class="hljs-comment">// 删除节点</span><br><span class="hljs-attr">removeChild</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">child</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">prepareToManageChildren</span>();<br>  <span class="hljs-title function_">enqueueRemove</span>(<span class="hljs-variable language_">this</span>, child.<span class="hljs-property">_mountIndex</span>);<br>&#125;,<br><br><span class="hljs-attr">_unmountChild</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">child</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeChild</span>(child);<br>  child.<span class="hljs-property">_mountIndex</span> = <span class="hljs-literal">null</span>;<br>&#125;,<br><br><span class="hljs-attr">_mountChildAtIndex</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span><br><span class="hljs-params">  child,</span><br><span class="hljs-params">  index,</span><br><span class="hljs-params">  transaction,</span><br><span class="hljs-params">  context</span>) &#123;<br>  <span class="hljs-keyword">var</span> mountImage = <span class="hljs-title class_">ReactReconciler</span>.<span class="hljs-title function_">mountComponent</span>(<br>    child,<br>    transaction,<br>    <span class="hljs-variable language_">this</span>,<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_nativeContainerInfo</span>,<br>    context<br>  );<br>  child.<span class="hljs-property">_mountIndex</span> = index;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createChild</span>(child, mountImage);<br>&#125;,<br></code></pre></td></tr></table></figure><p>当然，React diff 还是存在些许不足与待优化的地方，如下图所示，若新集合的节点更新为：D、A、B、C，与老集合对比只有 D 节点移动，而 A、B、C 仍然保持原有的顺序，理论上 diff 应该只需对 D 执行移动操作，然而由于 D 在老集合的位置是最大的，导致其他节点的 _mountIndex &lt; lastIndex，造成 D 没有执行移动操作，而是 A、B、C 全部移动到 D 节点后面的现象。</p><p>在此，读者们可以讨论思考：如何优化上述问题？</p><p>建议：在开发过程中，尽量减少类似将最后一个节点移动到列表首部的操作，当节点数量过大或更新操作过于频繁时，在一定程度上会影响 React 的渲染性能。</p><img src="https://cdn.houdemingxin.com/image/default/B8AD4130136341A49437BF897F910C0C-6-2.png" style="width: 100%;" /><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>React 通过制定大胆的 diff 策略，将 O(n3) 复杂度的问题转换成 O(n) 复杂度的问题；</li><li>React 通过分层求异的策略，对 tree diff 进行算法优化；</li><li>React 通过相同类生成相似树形结构，不同类生成不同树形结构的策略，对 component diff 进行算法优化；</li><li>React 通过设置唯一 key 的策略，对 element diff 进行算法优化；</li><li>建议，在开发组件时，保持稳定的 DOM 结构会有助于性能的提升；</li><li>建议，在开发过程中，尽量减少类似将最后一个节点移动到列表首部的操作，当节点数量过大或更新操作过于频繁时，在一定程度上会影响 - React 的渲染性能。</li></ul><p>转载： <a href="https://mp.weixin.qq.com/s/yqdCZFjO_9_WY-rEO01VMQ">https://mp.weixin.qq.com/s/yqdCZFjO_9_WY-rEO01VMQ</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JS中字符串的属性及方法</title>
    <link href="/2024/07/05/JS%E4%B8%AD%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8F%8A%E6%96%B9%E6%B3%95/"/>
    <url>/2024/07/05/JS%E4%B8%AD%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8F%8A%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="JS-中字符串的属性及方法"><a href="#JS-中字符串的属性及方法" class="headerlink" title="JS 中字符串的属性及方法"></a>JS 中字符串的属性及方法</h1><h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><h3 id="1-length"><a href="#1-length" class="headerlink" title="1. length"></a>1. length</h3><p>字符串的长度，即字符串中字符的个数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-property">length</span>); <span class="hljs-comment">// 11</span><br></code></pre></td></tr></table></figure><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><h3 id="2-charAt-index"><a href="#2-charAt-index" class="headerlink" title="2. charAt(index)"></a>2. charAt(index)</h3><p>返回指定位置的字符，index 为字符串中的索引，从 0 开始。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>)); <span class="hljs-comment">// h</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">1</span>)); <span class="hljs-comment">// e</span><br></code></pre></td></tr></table></figure><h3 id="3-charCodeAt-index"><a href="#3-charCodeAt-index" class="headerlink" title="3. charCodeAt(index)"></a>3. charCodeAt(index)</h3><p>返回指定位置的字符的 Unicode 编码，index 为字符串中的索引，从 0 开始。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>)); <span class="hljs-comment">// 104</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">1</span>)); <span class="hljs-comment">// 101</span><br></code></pre></td></tr></table></figure><h3 id="4-indexOf-searchValue-fromIndex"><a href="#4-indexOf-searchValue-fromIndex" class="headerlink" title="4. indexOf(searchValue, fromIndex)"></a>4. indexOf(searchValue, fromIndex)</h3><p>返回指定子字符串在原字符串中首次出现的位置，返回索引。未找到时返回 -1。可选参数 fromIndex 指定起始搜索位置。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;o&quot;</span>)); <span class="hljs-comment">// 4</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// 7</span><br></code></pre></td></tr></table></figure><h3 id="5-lastIndexOf-searchValue-fromIndex"><a href="#5-lastIndexOf-searchValue-fromIndex" class="headerlink" title="5. lastIndexOf(searchValue, fromIndex)"></a>5. lastIndexOf(searchValue, fromIndex)</h3><p>返回指定字符在字符串中最后一次出现的位置，fromIndex 为开始查找的位置，默认为字符串的长度。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">&quot;o&quot;</span>)); <span class="hljs-comment">// 7</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// 4</span><br></code></pre></td></tr></table></figure><h3 id="6-slice-start-end"><a href="#6-slice-start-end" class="headerlink" title="6. slice(start, end)"></a>6. slice(start, end)</h3><p>返回从 start 到 end（不包括 end）之间的字符串，start 和 end 为字符串中的索引，从 0 开始。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// hello</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>, <span class="hljs-number">11</span>)); <span class="hljs-comment">// world</span><br></code></pre></td></tr></table></figure><h3 id="7-substring-start-end"><a href="#7-substring-start-end" class="headerlink" title="7. substring(start, end)"></a>7. substring(start, end)</h3><p>返回从 start 到 end（不包括 end）之间的字符串，start 和 end 为字符串中的索引，从 0 开始。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// hello</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">6</span>, <span class="hljs-number">11</span>)); <span class="hljs-comment">// world</span><br></code></pre></td></tr></table></figure><h3 id="8-substr-start-length"><a href="#8-substr-start-length" class="headerlink" title="8. substr(start, length)"></a>8. substr(start, length)</h3><p>返回从 start 开始的 length 个字符，start 为字符串中的索引，从 0 开始。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// hello</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(<span class="hljs-number">6</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// world</span><br></code></pre></td></tr></table></figure><h3 id="9-split-separator-limit"><a href="#9-split-separator-limit" class="headerlink" title="9. split(separator, limit)"></a>9. split(separator, limit)</h3><p>将字符串分割成数组，separator 为分割符，limit 为返回数组的最大长度。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot; &quot;</span>)); <span class="hljs-comment">// [&quot;hello&quot;, &quot;world&quot;]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-number">1</span>)); <span class="hljs-comment">// [&quot;hello&quot;]</span><br></code></pre></td></tr></table></figure><h3 id="10-toLowerCase"><a href="#10-toLowerCase" class="headerlink" title="10. toLowerCase()"></a>10. toLowerCase()</h3><p>将字符串转换为小写。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;Hello World&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">toLowerCase</span>()); <span class="hljs-comment">// hello world</span><br></code></pre></td></tr></table></figure><h3 id="11-toUpperCase"><a href="#11-toUpperCase" class="headerlink" title="11. toUpperCase()"></a>11. toUpperCase()</h3><p>将字符串转换为大写。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;Hello World&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">toUpperCase</span>()); <span class="hljs-comment">// HELLO WORLD</span><br></code></pre></td></tr></table></figure><h3 id="12-trim"><a href="#12-trim" class="headerlink" title="12. trim()"></a>12. trim()</h3><p>去除字符串两端的空格。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;  hello world  &quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">trim</span>()); <span class="hljs-comment">// hello world</span><br></code></pre></td></tr></table></figure><h3 id="13-replace-searchValue-replaceValue"><a href="#13-replace-searchValue-replaceValue" class="headerlink" title="13. replace(searchValue, replaceValue)"></a>13. replace(searchValue, replaceValue)</h3><p>将字符串中的 searchValue 替换为 replaceValue。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-string">&quot;JavaScript&quot;</span>)); <span class="hljs-comment">// hello JavaScript</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/o/g</span>, <span class="hljs-string">&quot;a&quot;</span>)); <span class="hljs-comment">// hella warld</span><br></code></pre></td></tr></table></figure><h3 id="14-match-regexp"><a href="#14-match-regexp" class="headerlink" title="14. match(regexp)"></a>14. match(regexp)</h3><p>返回一个数组，包含字符串中与正则表达式匹配的子串。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/o/g</span>)); <span class="hljs-comment">// [&quot;o&quot;, &quot;o&quot;]</span><br></code></pre></td></tr></table></figure><h3 id="15-search-regexp"><a href="#15-search-regexp" class="headerlink" title="15. search(regexp)"></a>15. search(regexp)</h3><p>返回字符串中第一个与正则表达式匹配的子串的索引。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">search</span>(<span class="hljs-regexp">/o/</span>)); <span class="hljs-comment">// 4</span><br></code></pre></td></tr></table></figure><h3 id="16-trimLeft"><a href="#16-trimLeft" class="headerlink" title="16. trimLeft()"></a>16. trimLeft()</h3><p>去除字符串左端的空白字符。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;  hello world  &quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">trimLeft</span>()); <span class="hljs-comment">// hello world</span><br></code></pre></td></tr></table></figure><h3 id="17-trimRight"><a href="#17-trimRight" class="headerlink" title="17. trimRight()"></a>17. trimRight()</h3><p>去除字符串右端的空白字符。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;  hello world  &quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">trimRight</span>()); <span class="hljs-comment">//   hello world</span><br></code></pre></td></tr></table></figure><h3 id="18-includes-searchValue-fromIndex"><a href="#18-includes-searchValue-fromIndex" class="headerlink" title="18. includes(searchValue, fromIndex)"></a>18. includes(searchValue, fromIndex)</h3><p>判断字符串是否包含 searchValue，fromIndex 为开始搜索的位置。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;o&quot;</span>)); <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-number">8</span>)); <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><h3 id="19-startsWith-searchValue-fromIndex"><a href="#19-startsWith-searchValue-fromIndex" class="headerlink" title="19. startsWith(searchValue, fromIndex)"></a>19. startsWith(searchValue, fromIndex)</h3><p>判断字符串是否以 searchValue 开头，fromIndex 为开始搜索的位置。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;h&quot;</span>)); <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-number">1</span>)); <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><h3 id="20-endsWith-searchValue-fromIndex"><a href="#20-endsWith-searchValue-fromIndex" class="headerlink" title="20. endsWith(searchValue, fromIndex)"></a>20. endsWith(searchValue, fromIndex)</h3><p>判断字符串是否以 searchValue 结尾，fromIndex 为开始搜索的位置。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&quot;d&quot;</span>)); <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><h3 id="21-repeat-count"><a href="#21-repeat-count" class="headerlink" title="21. repeat(count)"></a>21. repeat(count)</h3><p>返回一个新字符串，该字符串包含 count 个 str 的副本。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">3</span>)); <span class="hljs-comment">// hellohellohello</span><br></code></pre></td></tr></table></figure><h3 id="22-concat-‘hole’-‘world’"><a href="#22-concat-‘hole’-‘world’" class="headerlink" title="22. concat(‘hole’, ‘world’)"></a>22. concat(‘hole’, ‘world’)</h3><p>将一个或多个字符串与原字符串连接合并，形成一个新的字符串并返回。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">concat</span>(<span class="hljs-string">&quot;world&quot;</span>)); <span class="hljs-comment">// helloworld</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">concat</span>(<span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-string">&quot;!&quot;</span>, <span class="hljs-string">&quot;!!!&quot;</span>)); <span class="hljs-comment">// helloworld!!!</span><br></code></pre></td></tr></table></figure><h3 id="23-at-index"><a href="#23-at-index" class="headerlink" title="23. at(index)"></a>23. at(index)</h3><p>返回指定位置的字符，支持负索引。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello world&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">at</span>(<span class="hljs-number">0</span>)); <span class="hljs-comment">// h</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">at</span>(-<span class="hljs-number">1</span>)); <span class="hljs-comment">// d</span><br></code></pre></td></tr></table></figure><h3 id="24-padStart-targetLength-padString"><a href="#24-padStart-targetLength-padString" class="headerlink" title="24. padStart(targetLength, padString)"></a>24. padStart(targetLength, padString)</h3><p>用 padString 填充字符串，使字符串达到 targetLength 的长度，从字符串的头部开始填充。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">padStart</span>(<span class="hljs-number">10</span>, <span class="hljs-string">&quot; &quot;</span>)); <span class="hljs-comment">//     hello</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">padStart</span>(<span class="hljs-number">10</span>, <span class="hljs-string">&quot;0&quot;</span>)); <span class="hljs-comment">// 00000hello</span><br></code></pre></td></tr></table></figure><h3 id="25-padEnd-targetLength-padString"><a href="#25-padEnd-targetLength-padString" class="headerlink" title="25. padEnd(targetLength, padString)"></a>25. padEnd(targetLength, padString)</h3><p>用 padString 填充字符串，使字符串达到 targetLength 的长度，从字符串的尾部开始填充。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;hello&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">padEnd</span>(<span class="hljs-number">10</span>, <span class="hljs-string">&quot; &quot;</span>)); <span class="hljs-comment">// hello</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">padEnd</span>(<span class="hljs-number">10</span>, <span class="hljs-string">&quot;0&quot;</span>)); <span class="hljs-comment">// hello00000</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>JS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Websoket的使用及封装</title>
    <link href="/2024/07/02/websoket%E5%9C%A8%E5%89%8D%E7%AB%AF%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%B0%81%E8%A3%85/"/>
    <url>/2024/07/02/websoket%E5%9C%A8%E5%89%8D%E7%AB%AF%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%B0%81%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h2 id="Websoket-的使用及封装"><a href="#Websoket-的使用及封装" class="headerlink" title="Websoket 的使用及封装"></a>Websoket 的使用及封装</h2><h4 id="WebSocket-是什么？"><a href="#WebSocket-是什么？" class="headerlink" title="WebSocket 是什么？"></a>WebSocket 是什么？</h4><p>WebSocket 是基于 TCP 的一种新的应用层网络协议。它提供了一个<strong>全双工</strong>的通道，允许服务器和客户端之间实时双向通信。因此，在 WebSocket 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输，客户端和服务器之间的数据交换变得更加简单。</p><h4 id="WebSocket-特点"><a href="#WebSocket-特点" class="headerlink" title="WebSocket 特点"></a>WebSocket 特点</h4><ul><li>建立在 TCP 协议之上，服务器端的实现比较容易。</li><li>与 HTTP 协议有着良好的兼容性。默认端口也是 80 和 443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。</li><li>数据格式比较轻量，性能开销小，通信高效。</li><li>可以发送文本，也可以发送二进制数据。</li><li>没有同源限制，客户端可以与任意服务器通信。</li><li>协议标识符是 ws（如果加密，则为 wss），服务器网址就是 URL。</li></ul><h4 id="WebSocket-优缺点"><a href="#WebSocket-优缺点" class="headerlink" title="WebSocket 优缺点"></a>WebSocket 优缺点</h4><h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><ul><li>较少的控制开销。</li><li>更强的实时性。</li><li>能更好的节省服务器资源和带宽。</li><li>支持双向通信，实时性更强。</li><li>更好的二进制支持。</li><li>支持扩展。</li></ul><h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><ul><li>协议标识符是 ws，而不是我们常使用的 http，所以无法通过浏览器直接访问，必须从支持 WebSocket 协议的客户端发起请求才能建立连接。</li><li>服务器端的实现必须对 WebSocket 协议进行支持。</li><li>客户端支持度不好，需要考虑浏览器兼容性。</li></ul><h4 id="与-HTTP-协议的区别"><a href="#与-HTTP-协议的区别" class="headerlink" title="与 HTTP 协议的区别"></a>与 HTTP 协议的区别</h4><p>与 HTTP 协议相比，WebSocket 具有以下优点：</p><ul><li>更高的实时性能：WebSocket 允许服务器和客户端之间实时双向通信，从而提高了实时通信场景中的性能。</li><li>更少的网络开销：HTTP 请求和响应之间需要额外的数据传输，而 WebSocket 通过在同一个连接上双向通信，减少了网络开销。</li><li>更灵活的通信方式：HTTP 请求和响应通常是一一对应的，而 WebSocket 允许服务器和客户端之间以多种方式进行通信，例如消息 Push、事件推送等。</li><li>更简洁的 API：WebSocket 提供了简洁的 API，使得客户端开发人员可以更轻松地进行实时通信。</li></ul><h4 id="WebSocket-对象的属性和方法："><a href="#WebSocket-对象的属性和方法：" class="headerlink" title="WebSocket 对象的属性和方法："></a>WebSocket 对象的属性和方法：</h4><ul><li><strong>WebSocket</strong> 对象：WebSocket 对象表示一个新的 WebSocket 连接。</li><li><strong>WebSocket.onopen</strong> 事件处理程序：当 WebSocket 连接打开时触发。</li><li><strong>WebSocket.onmessage</strong> 事件处理程序：当接收到来自 WebSocket 的消息时触发。</li><li><strong>WebSocket.onerror</strong> 事件处理程序：当 WebSocket 发生错误时触发。</li><li><strong>WebSocket.onclose</strong> 事件处理程序：当 WebSocket 连接关闭时触发。</li><li><strong>WebSocket.send</strong> 方法：向 WebSocket 发送数据。</li><li><strong>WebSocket.close</strong> 方法：关闭 WebSocket 连接。</li></ul><h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><ol><li>创建和连接 WebSocket</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 创建WebSocket对象</span><br><span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&quot;ws://localhost:8080&quot;</span>);<br></code></pre></td></tr></table></figure><p>其中，ws:&#x2F;&#x2F;localhost:8080 是 WebSocket 的 URL，表示要连接的服务器。</p><ol start="2"><li>连接 WebSocket</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 连接成功事件</span><br>socket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket 连接已打开&quot;</span>);<br>&#125;;<br></code></pre></td></tr></table></figure><ol start="3"><li>接收来自 WebSocket 的消息</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 接收到消息事件</span><br>socket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;接收到消息：&quot;</span>, event.<span class="hljs-property">data</span>);<br>&#125;;<br></code></pre></td></tr></table></figure><ol start="4"><li>向 WebSocket 发送消息</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 发送消息</span><br>socket.<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;Hello, WebSocket!&quot;</span>);<br></code></pre></td></tr></table></figure><ol start="5"><li>关闭 WebSocket 连接</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 关闭WebSocket连接</span><br>socket.<span class="hljs-title function_">close</span>();<br></code></pre></td></tr></table></figure><h4 id="WebSocket-代码示例"><a href="#WebSocket-代码示例" class="headerlink" title="WebSocket 代码示例"></a>WebSocket 代码示例</h4><p>以下是一个简单的 WebSocket 示例，通过 WebSocket 向服务器发送数据，并接收服务器返回的数据：</p><ol><li>首先，创建一个 HTML 文件，添加一个按钮和一个用于显示消息的文本框：</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>WebSocket 示例<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sendBtn&quot;</span>&gt;</span>发送消息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;messageBox&quot;</span> <span class="hljs-attr">readonly</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;main.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>接下来，创建一个 JavaScript 文件（例如 main.js），并在其中编写以下代码：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 获取按钮和文本框元素</span><br><span class="hljs-keyword">const</span> sendBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;sendBtn&quot;</span>);<br><span class="hljs-keyword">const</span> messageBox = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;messageBox&quot;</span>);<br><br><span class="hljs-comment">// 创建 WebSocket 对象</span><br><span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&quot;ws://localhost:8080&quot;</span>); <span class="hljs-comment">// 使用一个 WebSocket 服务器进行测试</span><br><br><span class="hljs-comment">// 设置 WebSocket 连接打开时的回调函数</span><br>socket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket 连接已打开&quot;</span>);<br>&#125;;<br><br><span class="hljs-comment">// 设置 WebSocket 接收到消息时的回调函数</span><br>socket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket 接收到消息:&quot;</span>, event.<span class="hljs-property">data</span>);<br>  messageBox.<span class="hljs-property">value</span> += event.<span class="hljs-property">data</span> + <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;;<br><br><span class="hljs-comment">// 设置 WebSocket 发生错误时的回调函数</span><br>socket.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket 发生错误&quot;</span>);<br>&#125;;<br><br><span class="hljs-comment">// 设置 WebSocket 连接关闭时的回调函数</span><br>socket.<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket 连接已关闭&quot;</span>);<br>&#125;;<br><br><span class="hljs-comment">// 点击按钮时发送消息</span><br>sendBtn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> message = <span class="hljs-string">&quot;Hello, WebSocket!&quot;</span>;<br>  socket.<span class="hljs-title function_">send</span>(message);<br>  messageBox.<span class="hljs-property">value</span> += <span class="hljs-string">&quot;发送消息: &quot;</span> + message + <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="WebSocket-应用场景"><a href="#WebSocket-应用场景" class="headerlink" title="WebSocket 应用场景"></a>WebSocket 应用场景</h4><ul><li>实时聊天应用：WebSocket 可以支持在线聊天室、即时通讯工具等，实现用户之间的实时消息交换 。</li><li>协同编辑：在多人协作编辑文档或编程时，WebSocket 可以确保所有参与者对文档的更改能够实时同步 。</li><li>在线游戏：WebSocket 适用于需要实时状态同步和玩家交互的多人在线游戏 。</li><li>实时数据更新：例如股票、外汇市场的实时报价更新，新闻或社交媒体的实时推送通知 。</li><li>物联网(IoT)：在智能家居、工业自动化等场景中，WebSocket 可以用于设备状态的实时监控和远程控制 。</li><li>地理定位应用：实时位置追踪和导航应用中的动态路线更新 。</li><li>直播互动：直播平台中的实时评论、弹幕、礼物赠送等功能 。</li><li>数据分析与监控：实时仪表盘、日志流处理、性能监控系统的实时数据展示与报警 。</li><li>多媒体聊天：WebSocket 结合 HTML5 音视频元素，可以用于视频会议等多媒体聊天场景 。</li><li>基于位置的应用：WebSocket 可以用于基于 GPS 的实时位置数据传输，如运动轨迹记录或实时数据仪表盘更新 。</li><li>在线教育：WebSocket 可以用于在线教育平台，支持多媒体聊天、文字聊天以及在公共数字黑板上的协作 。</li></ul><h4 id="利用单例模式创建-Websocket-连接"><a href="#利用单例模式创建-Websocket-连接" class="headerlink" title="利用单例模式创建 Websocket 连接"></a>利用单例模式创建 Websocket 连接</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketSingleton</span> &#123;<br>  <span class="hljs-keyword">static</span> instance;<br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">url</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">WebSocketSingleton</span>.<span class="hljs-property">instance</span>) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-title class_">WebSocketSingleton</span>.<span class="hljs-property">instance</span>;<br>    &#125;<br><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">url</span> = url;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span> = <span class="hljs-literal">null</span>;<br><br>    <span class="hljs-title class_">WebSocketSingleton</span>.<span class="hljs-property">instance</span> = <span class="hljs-variable language_">this</span>;<br>  &#125;<br><br>  <span class="hljs-title function_">connect</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>) &#123;<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">url</span>);<br><br>    <span class="hljs-comment">// 连接成功时的回调函数</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket连接已打开&quot;</span>);<br>    &#125;;<br><br>    <span class="hljs-comment">// 接收到消息时的回调函数</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;接收到消息:&quot;</span>, event.<span class="hljs-property">data</span>);<br>    &#125;;<br><br>    <span class="hljs-comment">// 发生错误时的回调函数</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket发生错误&quot;</span>);<br>    &#125;;<br><br>    <span class="hljs-comment">// 连接关闭时的回调函数</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;WebSocket连接已关闭&quot;</span>);<br>    &#125;;<br>  &#125;<br><br>  <span class="hljs-title function_">send</span>(<span class="hljs-params">message</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-title function_">send</span>(message);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;WebSocket连接未建立&quot;</span>);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-title function_">close</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-title function_">close</span>();<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// 使用示例</span><br><span class="hljs-keyword">const</span> webSocket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketSingleton</span>(<span class="hljs-string">&quot;ws://localhost:8080&quot;</span>);<br>webSocket.<span class="hljs-title function_">connect</span>();<br>webSocket.<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;Hello, WebSocket!&quot;</span>);<br>webSocket.<span class="hljs-title function_">close</span>();<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Websoket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTML</title>
    <link href="/2024/06/15/html/"/>
    <url>/2024/06/15/html/</url>
    
    <content type="html"><![CDATA[<h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h3><h5 id="行内标签"><a href="#行内标签" class="headerlink" title="行内标签"></a>行内标签</h5><pre><code class="hljs">&lt;a&gt; 链接&lt;b&gt; 加粗&lt;i&gt; 斜体&lt;u&gt; 下划线&lt;s&gt; 删除线&lt;sub&gt; 下标&lt;sup&gt; 上标&lt;span&gt; 行内容器&lt;img&gt; 图片&lt;input&gt; 输入框&lt;label&gt; 表单标签&lt;select&gt; 下拉选择框&lt;textarea&gt; 多行文本框&lt;button&gt; 按钮&lt;br&gt; 换行&lt;hr&gt; 水平线</code></pre><h5 id="块级标签"><a href="#块级标签" class="headerlink" title="块级标签"></a>块级标签</h5><pre><code class="hljs">&lt;div&gt; 块级容器&lt;p&gt; 段落&lt;h1&gt; ~ &lt;h6&gt; 标题&lt;ul&gt; 无序列表&lt;ol&gt; 有序列表&lt;dl&gt; 定义列表&lt;table&gt; 表格&lt;form&gt; 表单&lt;fieldset&gt; 表单域&lt;legend&gt; 表单域标题&lt;blockquote&gt; 块引用&lt;pre&gt; 预格式化文本&lt;address&gt; 地址&lt;center&gt; 居中</code></pre><h3 id="盒模型"><a href="#盒模型" class="headerlink" title="盒模型"></a>盒模型</h3><h5 id="标准盒模型"><a href="#标准盒模型" class="headerlink" title="标准盒模型"></a>标准盒模型</h5><pre><code class="hljs">width = contentheight = content模型转换box-sizing: content-box; // 标准盒模型</code></pre><h5 id="IE-盒模型"><a href="#IE-盒模型" class="headerlink" title="IE 盒模型"></a>IE 盒模型</h5><pre><code class="hljs">width = content + padding + borderheight = content + padding + border模型转换box-sizing: border-box; // IE盒模型</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>HTML</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS</title>
    <link href="/2024/06/14/CSS/"/>
    <url>/2024/06/14/CSS/</url>
    
    <content type="html"><![CDATA[<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h3><ul><li>基本选择器<ul><li>标签选择器</li><li>类选择器</li><li>id 选择器</li><li>通配符选择器</li><li>属性选择器</li><li>伪类选择器</li><li>伪元素选择器</li></ul></li><li>组合选择器<ul><li>后代选择器</li><li>子元素选择器</li><li>相邻兄弟选择器</li><li>通用兄弟选择器</li></ul></li><li>伪类选择器<ul><li>动态伪类选择器</li></ul></li></ul><h3 id="重绘重排"><a href="#重绘重排" class="headerlink" title="重绘重排"></a>重绘重排</h3><ul><li><p>重绘</p><ul><li>元素的外观发生改变时会触发重绘，例如：修改元素的颜色或者背景色时会导致页面重新绘制</li></ul></li><li><p>重排</p><ul><li>指页面重新排列，dom 的变化影响了元素的布局，例如：页面初始化时，对 dom 节点进行增删改时，浏览器窗口的 resize 发生改变时都会触发重排</li></ul></li><li><p>重排必然会导致重绘，重绘不一定导致重排</p></li><li><p>display:none; (隐藏元素不占位) 会导致重排和重绘</p></li><li><p>visibility:hidden; (隐藏元素占位) 只会导致重绘，不会导致重排</p></li></ul><h3 id="响应式布局"><a href="#响应式布局" class="headerlink" title="响应式布局"></a>响应式布局</h3><ul><li>媒体查询<ul><li>媒体查询是 CSS3 引入的，通过媒体查询可以针对不同的媒体类型定义不同的样式</li><li>媒体查询可以针对不同的屏幕尺寸、不同的设备类型、不同的设备方向进行响应式布局</li><li>媒体查询的语法格式如下：</li></ul></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@media</span> mediatype <span class="hljs-keyword">and</span>|<span class="hljs-keyword">not</span>|<span class="hljs-keyword">only</span> (media feature) &#123;<br>  CSS代码;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>媒体查询的 mediatype 属性<ul><li>all: 用于所有设备</li><li>print: 用于打印机和打印预览</li><li>screen: 用于电脑屏幕、平板电脑、智能手机等</li><li>speech: 用于屏幕阅读器等发声设备</li></ul></li><li>媒体查询的 media feature 属性<ul><li>width: 定义视口的宽度</li><li>height: 定义视口的高度</li><li>max-width: 定义视口的最大宽度</li><li>min-width: 定义视口的最小宽度</li><li>max-height: 定义视口的最大高度</li><li>min-height: 定义视口的最小高度</li><li>orientation: 定义视口的横纵比例</li><li>aspect-ratio: 定义视口的宽高比例</li><li>color: 定义视口的颜色深度</li><li>color-index: 定义视口的颜色索引值</li><li>resolution: 定义视口的分辨率</li><li>scan: 定义视口的扫描方式</li><li>grid: 定义视口的栅格是否为网格</li><li>pointer: 定义视口的指针类型</li><li>hover: 定义视口的鼠标悬停状态</li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JS</title>
    <link href="/2024/06/13/js/"/>
    <url>/2024/06/13/js/</url>
    
    <content type="html"><![CDATA[<h2 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ES6</title>
    <link href="/2024/06/12/es6/"/>
    <url>/2024/06/12/es6/</url>
    
    <content type="html"><![CDATA[<h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>浏览器</title>
    <link href="/2024/06/11/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    <url>/2024/06/11/%E6%B5%8F%E8%A7%88%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>React</title>
    <link href="/2024/06/10/react/"/>
    <url>/2024/06/10/react/</url>
    
    <content type="html"><![CDATA[<h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Vue</title>
    <link href="/2024/06/10/VUE/"/>
    <url>/2024/06/10/VUE/</url>
    
    <content type="html"><![CDATA[<h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Webpack</title>
    <link href="/2024/06/10/webpack/"/>
    <url>/2024/06/10/webpack/</url>
    
    <content type="html"><![CDATA[<h2 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>TS</title>
    <link href="/2024/06/10/TS/"/>
    <url>/2024/06/10/TS/</url>
    
    <content type="html"><![CDATA[<h2 id="TS"><a href="#TS" class="headerlink" title="TS"></a>TS</h2><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><ul><li>布尔类型(boolean)</li><li>数字类型(number)</li><li>字符串类型(string)</li><li>数组类型(array)</li><li>元组类型(tuple)</li><li>枚举类型(enum)</li><li>任意类型(any)</li><li>空值类型(void)</li><li>对象类型(object)</li><li>联合类型(union)</li><li>类型断言(as)</li><li>类型推断(infer)</li><li>类型别名(type)</li><li>类型兼容性(compatible)</li><li>类型保护(protect)</li><li>类型声明(declare)</li><li>类型注解(annotate)</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>手写题</title>
    <link href="/2024/06/09/%E6%89%8B%E5%86%99%E9%A2%98/"/>
    <url>/2024/06/09/%E6%89%8B%E5%86%99%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="手写题"><a href="#手写题" class="headerlink" title="手写题"></a>手写题</h2><h4 id="实现-Promise-all"><a href="#实现-Promise-all" class="headerlink" title="实现 Promise.all"></a>实现 Promise.all</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//静态方法</span><br><span class="hljs-keyword">static</span> <span class="hljs-title function_">all</span>(<span class="hljs-params">promiseArr</span>) &#123;<br>  <span class="hljs-keyword">let</span> result = [];<br>  <span class="hljs-comment">//声明一个计数器 每一个promise返回就加一</span><br>  <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mypromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; promiseArr.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-comment">//这里用 Promise.resolve包装一下 防止不是Promise类型传进来</span><br>      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(promiseArr[i]).<span class="hljs-title function_">then</span>(<br>        <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;<br>          <span class="hljs-comment">//这里不能直接push数组  因为要控制顺序一一对应(感谢评论区指正)</span><br>          result[i] = res;<br>          count++;<br>          <span class="hljs-comment">//只有全部的promise执行成功之后才resolve出去</span><br>          <span class="hljs-keyword">if</span> (count === promiseArr.<span class="hljs-property">length</span>) &#123;<br>            <span class="hljs-title function_">resolve</span>(result);<br>          &#125;<br>        &#125;,<br>        <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>          <span class="hljs-title function_">reject</span>(err);<br>        &#125;<br>      );<br>    &#125;<br>  &#125;);<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="实现-Promise-finally"><a href="#实现-Promise-finally" class="headerlink" title="实现 Promise.finally"></a>实现 Promise.finally</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">finally</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<br>    <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">callback</span>()).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> value;<br>      &#125;);<br>    &#125;,<br>    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">callback</span>()).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">throw</span> err;<br>      &#125;);<br>    &#125;<br>  );<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="实现-Promise-allSettled"><a href="#实现-Promise-allSettled" class="headerlink" title="实现 Promise.allSettled"></a>实现 Promise.allSettled</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">allSettled</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">promiseArr</span>) &#123;<br>  <span class="hljs-keyword">let</span> result = [];<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    promiseArr.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">p, i</span>) =&gt;</span> &#123;<br>      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(p).<span class="hljs-title function_">then</span>(<br>        <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> &#123;<br>          result.<span class="hljs-title function_">push</span>(&#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;fulfilled&quot;</span>,<br>            <span class="hljs-attr">value</span>: val,<br>          &#125;);<br>          <span class="hljs-keyword">if</span> (result.<span class="hljs-property">length</span> === promiseArr.<span class="hljs-property">length</span>) &#123;<br>            <span class="hljs-title function_">resolve</span>(result);<br>          &#125;<br>        &#125;,<br>        <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>          result.<span class="hljs-title function_">push</span>(&#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;rejected&quot;</span>,<br>            <span class="hljs-attr">reason</span>: err,<br>          &#125;);<br>          <span class="hljs-keyword">if</span> (result.<span class="hljs-property">length</span> === promiseArr.<span class="hljs-property">length</span>) &#123;<br>            <span class="hljs-title function_">resolve</span>(result);<br>          &#125;<br>        &#125;<br>      );<br>    &#125;);<br>  &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="实现-Promise-race"><a href="#实现-Promise-race" class="headerlink" title="实现 Promise.race"></a>实现 Promise.race</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js">  <span class="hljs-comment">//静态方法</span><br>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">race</span>(<span class="hljs-params">promiseArr</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mypromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; promiseArr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(promiseArr[i]).<span class="hljs-title function_">then</span>(<br>          <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;<br>            <span class="hljs-comment">//promise数组只要有任何一个promise 状态变更  就可以返回</span><br>            <span class="hljs-title function_">resolve</span>(res);<br>          &#125;,<br>          <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>            <span class="hljs-title function_">reject</span>(err);<br>          &#125;<br>        );<br>      &#125;<br>    &#125;);<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a>数组去重</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//reduce + includes 去重</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniq</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (!prev.<span class="hljs-title function_">includes</span>(next)) &#123;<br>      prev.<span class="hljs-title function_">push</span>(next);<br>    &#125;<br>    <span class="hljs-keyword">return</span> prev;<br>  &#125;, []);<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">uniq</span>(arr));<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">unq</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (!prev.<span class="hljs-title function_">includes</span>(next)) &#123;<br>      prev.<span class="hljs-title function_">push</span>(next);<br>    &#125;<br>    <span class="hljs-keyword">return</span> prev;<br>  &#125;, []);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="数组扁平化"><a href="#数组扁平化" class="headerlink" title="数组扁平化"></a>数组扁平化</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">flot</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">let</span> result = [];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr[i])) &#123;<br>      result = result.<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">flot</span>(arr[i]));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      retult = result.<span class="hljs-title function_">push</span>(arr[i]);<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flot</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> prev.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(next) ? <span class="hljs-title function_">flat</span>(next) : next);<br>  &#125;, []);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="实现es6数组的forEach方法"><a href="#实现es6数组的forEach方法" class="headerlink" title="实现es6数组的forEach方法"></a>实现<code>es6</code>数组的<code>forEach</code>方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myForEach</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">fn</span>) &#123;<br>  <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-title function_">fn</span>(arr[i], i, arr);<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="实现es6数组的filter方法"><a href="#实现es6数组的filter方法" class="headerlink" title="实现es6数组的filter方法"></a>实现<code>es6</code>数组的<code>filter</code>方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">myFilter</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>    <span class="hljs-keyword">let</span> newArr = [];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_">fn</span>(arr[i], i, arr)) &#123;<br>            newArr.<span class="hljs-title function_">push</span>(arr[i]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> newArr;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="实现es6数组的reduce方法"><a href="#实现es6数组的reduce方法" class="headerlink" title="实现es6数组的reduce方法"></a>实现<code>es6</code>数组的<code>reduce</code>方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myReduce</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">fn, params</span>) &#123;<br>  <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>  <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">let</span> prev = params;<br>  <span class="hljs-keyword">if</span> (!params) &#123;<br>    index = <span class="hljs-number">1</span>;<br>    prev = arr[<span class="hljs-number">0</span>];<br>  &#125;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    prev = <span class="hljs-title function_">fn</span>(prev, arr[i], i, arr);<br>  &#125;<br>  <span class="hljs-keyword">return</span> prev;<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="实现es6数组的map方法"><a href="#实现es6数组的map方法" class="headerlink" title="实现es6数组的map方法"></a>实现<code>es6</code>数组的<code>map</code>方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">myMap</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>    <span class="hljs-keyword">let</span> newArr = [];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        newArr.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">fn</span>(arr[i], i, arr));<br>    &#125;<br>    <span class="hljs-keyword">return</span> newArr;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="实现es6数组的find方法"><a href="#实现es6数组的find方法" class="headerlink" title="实现es6数组的find方法"></a>实现<code>es6</code>数组的<code>find</code>方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">myFind</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_">fn</span>(arr[i], i, arr)) &#123;<br>            <span class="hljs-keyword">return</span> arr[i];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="实现es6数组的findIndex方法"><a href="#实现es6数组的findIndex方法" class="headerlink" title="实现es6数组的findIndex方法"></a>实现<code>es6</code>数组的<code>findIndex</code>方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myFindIndex</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">fn</span>) &#123;<br>  <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">fn</span>(arr[i], i, arr)) &#123;<br>      <span class="hljs-keyword">return</span> i;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="实现es6数组的every方法"><a href="#实现es6数组的every方法" class="headerlink" title="实现es6数组的every方法"></a>实现<code>es6</code>数组的<code>every</code>方法</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myEvery</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_">fn</span>(arr[i], i, arr))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="实现es6数组的some方法"><a href="#实现es6数组的some方法" class="headerlink" title="实现es6数组的some方法"></a>实现<code>es6</code>数组的<code>some</code>方法</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mySome</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_">fn</span>(arr[i], i, arr)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="实现es6数组的includes方法"><a href="#实现es6数组的includes方法" class="headerlink" title="实现es6数组的includes方法"></a>实现<code>es6</code>数组的<code>includes</code>方法</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myIncludes</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">value, index</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>    <span class="hljs-comment">// 第二个参数为整数，从前面第index个位置往后找</span><br>    <span class="hljs-comment">// 为负数，从后面数index个开始往后找</span><br>    <span class="hljs-comment">// 如果不输入从0开始向后找</span><br>    <span class="hljs-keyword">let</span> fIndex = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(index !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> index === <span class="hljs-string">&#x27;number&#x27;</span> &amp;&amp; !<span class="hljs-built_in">isNaN</span> &amp;&amp; index !== <span class="hljs-title class_">Infinity</span>) fIndex = index;<br>    <span class="hljs-keyword">if</span>(fIndex &lt; <span class="hljs-number">0</span>) fIndex = arr.<span class="hljs-property">length</span>+fIndex;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=fIndex; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-comment">// Object.is(value1, value2) 判断两个值是否为同一个值</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">is</span>(arr[i], value)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="实现es6数组的flat方法"><a href="#实现es6数组的flat方法" class="headerlink" title="实现es6数组的flat方法"></a>实现<code>es6</code>数组的<code>flat</code>方法</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myFlat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">value = <span class="hljs-number">1</span></span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = [...<span class="hljs-variable language_">this</span>];<br>    <span class="hljs-keyword">if</span>(value === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> arr;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">&quot;number&quot;</span> || <span class="hljs-built_in">isNaN</span>(value)) value = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(next)) &#123;<br>            <span class="hljs-keyword">return</span> [...prev, ...next.<span class="hljs-title function_">myFlat</span>(value-<span class="hljs-number">1</span>)];<br>        &#125;<br>        <span class="hljs-keyword">return</span> [...prev, next];<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="实现防抖-debounce"><a href="#实现防抖-debounce" class="headerlink" title="实现防抖 debounce"></a>实现防抖 debounce</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, time</span>) &#123;<br>  <span class="hljs-comment">//要限制防抖的函数,限制时间</span><br>  <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (!timer) &#123;<br>      <span class="hljs-built_in">clearInterval</span>(timer);<br>    &#125;<br>    timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>); <span class="hljs-comment">//当前this指向btn，实参集合</span><br>    &#125;, time);<br>  &#125;;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="实现节流函数-throttle"><a href="#实现节流函数-throttle" class="headerlink" title="实现节流函数 throttle"></a>实现节流函数 throttle</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">throttle</span>(<span class="hljs-params">fn, time</span>) &#123;<br>  <span class="hljs-keyword">let</span> date = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> newDate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();<br>    <span class="hljs-keyword">if</span> (newDate - date &gt; time) &#123;<br>      fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>);<br>      date = newDate;<br>    &#125;<br>  &#125;;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="写一个完整的深拷贝"><a href="#写一个完整的深拷贝" class="headerlink" title="写一个完整的深拷贝"></a>写一个完整的深拷贝</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">obj</span>) &#123;<br>       <span class="hljs-keyword">let</span> newObj = obj instancef <span class="hljs-title class_">Array</span> ? [] : &#123;&#125;  <span class="hljs-comment">//判断传入的值是不是数组 true?[]:&#123;&#125;</span><br>       <span class="hljs-keyword">if</span> (obj &amp;&amp; <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">&quot;object&quot;</span>) &#123;  <span class="hljs-comment">//判断传入的值是不是object</span><br>           <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> obj) &#123; <span class="hljs-comment">//如果是for in 循环</span><br>               <span class="hljs-keyword">if</span> (obj.<span class="hljs-title function_">hasOwnProperty</span>(key)) &#123;  <span class="hljs-comment">//</span><br>                   <span class="hljs-keyword">if</span> (obj[key] &amp;&amp; <span class="hljs-keyword">typeof</span> obj[key] === <span class="hljs-string">&#x27;object&#x27;</span>) &#123;<br>                       newObj[key] = <span class="hljs-title function_">deepClone</span>(obj[key])<br>                   &#125; <span class="hljs-keyword">else</span> &#123;<br>                       newObj[key] = obj[key]<br>                   &#125;<br>               &#125;<br>           &#125;<br>       &#125;<br>       <span class="hljs-keyword">return</span> newObj  <span class="hljs-comment">//不是 直接返回</span><br>   &#125;<br>   <span class="hljs-keyword">let</span> a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>   <span class="hljs-keyword">let</span> b = <span class="hljs-title function_">deepClone</span>(a)<br>   a[<span class="hljs-number">0</span>] = <span class="hljs-number">2</span><br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a, b);<br></code></pre></td></tr></table></figure><h4 id="实现-new-关键字编写"><a href="#实现-new-关键字编写" class="headerlink" title="实现 new 关键字编写"></a>实现 new 关键字编写</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>  <span class="hljs-title class_">Constructor</span> = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);<br>  obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;<br>  <span class="hljs-keyword">var</span> ret = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, <span class="hljs-variable language_">arguments</span>);<br><br>  <span class="hljs-comment">// ret || obj 这里这么写考虑了构造函数显示返回 null 的情况</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> ret === <span class="hljs-string">&quot;object&quot;</span> ? ret || obj : obj;<br>&#125;<br><span class="hljs-comment">//使用</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">person</span>(<span class="hljs-params">name, age</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>&#125;<br><span class="hljs-keyword">let</span> p = <span class="hljs-title function_">objectFactory</span>(person, <span class="hljs-string">&quot;布兰&quot;</span>, <span class="hljs-number">12</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p); <span class="hljs-comment">// &#123; name: &#x27;布兰&#x27;, age: 12 &#125;</span><br></code></pre></td></tr></table></figure><h4 id="Es5-实现继承-Es6-实现继承"><a href="#Es5-实现继承-Es6-实现继承" class="headerlink" title="Es5 实现继承&amp;Es6 实现继承"></a>Es5 实现继承&amp;Es6 实现继承</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 原型链继承</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span> = [<span class="hljs-string">&quot;black&quot;</span>, <span class="hljs-string">&quot;white&quot;</span>];<br>&#125;<br><span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>;<br>&#125;;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params"></span>) &#123;&#125;<br><span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();<br><br><span class="hljs-keyword">let</span> dog1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();<br>dog1.<span class="hljs-property">colors</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">&quot;brown&quot;</span>);<br><span class="hljs-keyword">let</span> dog2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog2.<span class="hljs-property">colors</span>); <span class="hljs-comment">// [&#x27;black&#x27;, &#x27;white&#x27;, &#x27;brown&#x27;]</span><br><br><span class="hljs-comment">// 组合继承</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span> = [<span class="hljs-string">&quot;black&quot;</span>, <span class="hljs-string">&quot;white&quot;</span>];<br>&#125;<br><span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>&#125;;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name, age</span>) &#123;<br>  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>&#125;<br><span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();<br><span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Dog</span>;<br><br><span class="hljs-keyword">let</span> dog1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">&quot;奶昔&quot;</span>, <span class="hljs-number">2</span>);<br>dog1.<span class="hljs-property">colors</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">&quot;brown&quot;</span>);<br><span class="hljs-keyword">let</span> dog2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">&quot;哈赤&quot;</span>, <span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog2);<br><span class="hljs-comment">// &#123; name: &quot;哈赤&quot;, colors: [&quot;black&quot;, &quot;white&quot;], age: 1 &#125;</span><br><br><span class="hljs-comment">// 借用构造函数(经典继承)</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>  &#125;;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name</span>) &#123;<br>  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);<br>&#125;<br><span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();<br><br><span class="hljs-comment">// 寄生组合式继承</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">object</span>(<span class="hljs-params">o</span>) &#123;<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">F</span>(<span class="hljs-params"></span>) &#123;&#125;<br>  F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = o;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">inheritPrototype</span>(<span class="hljs-params">child, parent</span>) &#123;<br>  <span class="hljs-keyword">let</span> prototype = <span class="hljs-title function_">object</span>(parent.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);<br>  prototype.<span class="hljs-property">constructor</span> = child;<br>  child.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = prototype;<br>&#125;<br><span class="hljs-title function_">inheritPrototype</span>(<span class="hljs-title class_">Dog</span>, <span class="hljs-title class_">Animal</span>);<br><span class="hljs-comment">//class实现继承</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>  &#125;<br>  <span class="hljs-title function_">getName</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>  &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age</span>) &#123;<br>    <span class="hljs-variable language_">super</span>(name);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="手写-Call"><a href="#手写-Call" class="headerlink" title="手写 Call"></a>手写 Call</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>, a, b, c, d);<br>&#125;<br><span class="hljs-keyword">let</span> egg = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;小雅&quot;</span>,<br>&#125;;<br><span class="hljs-comment">// 封装mycall</span><br><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mycall</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) &#123;<br>  obj = obj || <span class="hljs-variable language_">window</span>; <span class="hljs-comment">//这里注意this不能指向null</span><br>  <span class="hljs-keyword">let</span> newArgs = []; <span class="hljs-comment">//需要拿到每一个arguments集合</span><br>  obj.<span class="hljs-property">fn</span> = <span class="hljs-variable language_">this</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-comment">//循环arguments集合,这里从下标1开始，第0项是this指向</span><br>    newArgs.<span class="hljs-title function_">push</span>(<span class="hljs-string">`arguments[<span class="hljs-subst">$&#123;i&#125;</span>]`</span>);<br>  &#125;<br>  <span class="hljs-keyword">let</span> res = <span class="hljs-built_in">eval</span>(<span class="hljs-string">`obj.fn(<span class="hljs-subst">$&#123;newArgs&#125;</span>)`</span>);<br>  <span class="hljs-keyword">delete</span> obj.<span class="hljs-property">fn</span>;<br>  <span class="hljs-keyword">return</span> res;<br>&#125;;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-title function_">mycall</span>(egg, &#123;&#125;, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>));<br><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">call</span>(egg, &#123;&#125;, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mycall</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) &#123;<br>  obj = obj || <span class="hljs-variable language_">window</span>;<br>  obj.<span class="hljs-property">fn</span> = <span class="hljs-variable language_">this</span>;<br><br>  <span class="hljs-keyword">delete</span> obj.<span class="hljs-property">fn</span>;<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="手写-Apply"><a href="#手写-Apply" class="headerlink" title="手写 Apply"></a>手写 Apply</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">a, b</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>, a, b);<br>  <span class="hljs-comment">// return 123</span><br>&#125;<br><span class="hljs-keyword">let</span> egg = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;小雅&quot;</span>,<br>&#125;;<br><span class="hljs-comment">//封装myapply</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">        1.需要注意的是第二个参数</span><br><span class="hljs-comment">        2.this指向问题</span><br><span class="hljs-comment">        3.返回值</span><br><span class="hljs-comment">        4.this为null时</span><br><span class="hljs-comment">    */</span><br><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myapply</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">obj, args</span>) &#123;<br>  obj = obj || <span class="hljs-variable language_">window</span>; <span class="hljs-comment">//这里注意this不能指向null</span><br>  <span class="hljs-keyword">let</span> newArgs = []; <span class="hljs-comment">//需要拿到每一个arguments集合</span><br>  <span class="hljs-keyword">let</span> res = <span class="hljs-literal">null</span>;<br>  obj.<span class="hljs-property">fn</span> = <span class="hljs-variable language_">this</span>;<br>  <span class="hljs-keyword">if</span> (!args) &#123;<br>    <span class="hljs-comment">// 如果没有传第二个参数 直接返回当前的方法</span><br>    res = obj.<span class="hljs-title function_">fn</span>();<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">//如果有 循环遍历把每一项放到一个空数组里 然后使用eval()函数 将方法调用并传入新数组</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; args.<span class="hljs-property">length</span>; i++) &#123;<br>      <span class="hljs-comment">//循环arguments集合,这里从下标1开始，第0项是this指向</span><br>      newArgs.<span class="hljs-title function_">push</span>(<span class="hljs-string">`args[<span class="hljs-subst">$&#123;i&#125;</span>]`</span>);<br>    &#125;<br>    res = <span class="hljs-built_in">eval</span>(<span class="hljs-string">`obj.fn(<span class="hljs-subst">$&#123;newArgs&#125;</span>)`</span>);<br>  &#125;<br>  <span class="hljs-keyword">delete</span> obj.<span class="hljs-property">fn</span>; <span class="hljs-comment">//删除当前的方法</span><br>  <span class="hljs-keyword">return</span> res; <span class="hljs-comment">//返回值</span><br>&#125;;<br><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">myapply</span>(egg, [<span class="hljs-number">1</span>, <span class="hljs-string">&quot;2&quot;</span>]);<br><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">apply</span>(egg, [<span class="hljs-number">1</span>, <span class="hljs-string">&quot;2&quot;</span>]);<br></code></pre></td></tr></table></figure><h4 id="手写-bind"><a href="#手写-bind" class="headerlink" title="手写 bind"></a>手写 bind</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">a, b</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>, a, b);<br>  <span class="hljs-comment">// return 123</span><br>&#125;<br><span class="hljs-keyword">let</span> egg = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;小雅&quot;</span>,<br>&#125;;<br><br><span class="hljs-comment">//封装bind方法</span><br><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mybind</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) &#123;<br>  <span class="hljs-keyword">let</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">//将伪数组转化为数组 arguments调用此方法 1 从下标1开始</span><br>  <span class="hljs-keyword">let</span> arg = <span class="hljs-literal">null</span>;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<br>  <span class="hljs-keyword">let</span> that = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">//获取到当前函数的this指向</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">//闭包的方式返回一个函数  //这里为es5方法 es6 ()=&gt;&#123;&#125; this继承父级 但是下边那个打印结果有问题，咱也不知道为啥</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<br>    arg = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);<br>    that.<span class="hljs-title function_">apply</span>(obj, [...args, ...arg]); <span class="hljs-comment">//这里考虑到了函数内部的值 合并一下参数</span><br>  &#125;;<br>&#125;;<br><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">mybind</span>(egg, <span class="hljs-number">1</span>)(<span class="hljs-number">2</span>); <span class="hljs-comment">//调用的时候为柯函数里化</span><br></code></pre></td></tr></table></figure><h4 id="实现柯里化函数"><a href="#实现柯里化函数" class="headerlink" title="实现柯里化函数"></a>实现柯里化函数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">curry</span>(<span class="hljs-params">fn, currArgs</span>) &#123;<br>  <span class="hljs-comment">// 这里的fn就是sum方法</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fn, currArgs);<br>    <span class="hljs-comment">// 首次调用时未提供参数currArgs，因此不用进行拼接执行</span><br>    <span class="hljs-keyword">if</span> (currArgs) &#123;<br>      args = args.<span class="hljs-title function_">concat</span>(currArgs); <span class="hljs-comment">// 这里的currArgs是上次递归传递进来的，也就是上次递归的args</span><br>    &#125;<br>    <span class="hljs-comment">// 递归调用</span><br>    <span class="hljs-keyword">if</span> (args.<span class="hljs-property">length</span> &lt; fn.<span class="hljs-property">length</span>) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-title function_">curry</span>(fn, args);<br>    &#125;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);<br>    <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args); <span class="hljs-comment">// 这里调用了apply方法，将收集起来的args参数全都传入fn中</span><br>  &#125;;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">a, b, c, d, e</span>) &#123;<br>  <span class="hljs-keyword">return</span> a + b + c + d + e;<br>&#125;<br><span class="hljs-keyword">const</span> fn = <span class="hljs-title function_">curry</span>(sum);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>)(<span class="hljs-number">2</span>)(<span class="hljs-number">3</span>)(<span class="hljs-number">4</span>)(<span class="hljs-number">5</span>)); <span class="hljs-comment">//  6</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>)(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// 6</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">//6</span><br></code></pre></td></tr></table></figure><h4 id="实现-jsonp"><a href="#实现-jsonp" class="headerlink" title="实现 jsonp"></a>实现 jsonp</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">jsonp</span> = (<span class="hljs-params">&#123; url, params, callbackName &#125;</span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">generateUrl</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">let</span> dataSrc = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> params) &#123;<br>      <span class="hljs-keyword">if</span> (params.<span class="hljs-title function_">hasOwnProperty</span>(key)) &#123;<br>        dataSrc += <span class="hljs-string">`<span class="hljs-subst">$&#123;key&#125;</span>=<span class="hljs-subst">$&#123;params[key]&#125;</span>&amp;`</span>;<br>      &#125;<br>    &#125;<br>    dataSrc += <span class="hljs-string">`callback=<span class="hljs-subst">$&#123;callbackName&#125;</span>`</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;url&#125;</span>?<span class="hljs-subst">$&#123;dataSrc&#125;</span>`</span>;<br>  &#125;;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> scriptEle = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;script&quot;</span>);<br>    scriptEle.<span class="hljs-property">src</span> = <span class="hljs-title function_">generateUrl</span>();<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(scriptEle);<br>    <span class="hljs-variable language_">window</span>[callbackName] = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>      <span class="hljs-title function_">resolve</span>(data);<br>      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeChild</span>(scriptEle);<br>    &#125;;<br>  &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="实现-instanceOf"><a href="#实现-instanceOf" class="headerlink" title="实现 instanceOf"></a>实现 instanceOf</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">instanceOf</span>(<span class="hljs-params">left, right</span>) &#123;<br>  <span class="hljs-keyword">let</span> proto = left.<span class="hljs-property">__proto__</span>;<br>  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>    <span class="hljs-keyword">if</span> (proto === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">if</span> (proto === right.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    proto = proto.<span class="hljs-property">__proto__</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="图片懒加载，实现lazyLoad-这个方法，使之只显示当前屏幕图片并测试"><a href="#图片懒加载，实现lazyLoad-这个方法，使之只显示当前屏幕图片并测试" class="headerlink" title="图片懒加载，实现lazyLoad()这个方法，使之只显示当前屏幕图片并测试"></a>图片懒加载，实现<code>lazyLoad()</code>这个方法，使之只显示当前屏幕图片并测试</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> imgSrc = [<br>    <span class="hljs-string">&quot;./image/01.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/02.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/03.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/04.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/05.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/06.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/07.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/08.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/09.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/10.jpg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/11.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/12.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/13.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/14.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/15.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/16.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/17.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/18.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/19.jpeg&quot;</span>,<br>    <span class="hljs-string">&quot;./image/20.jpeg&quot;</span><br>];<br><span class="hljs-keyword">let</span> image = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;image&#x27;</span>);<br><span class="hljs-keyword">let</span> imgs = [...image.<span class="hljs-property">children</span>];<br><span class="hljs-comment">// 设置图片的自定定义属性src</span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;imgs.<span class="hljs-property">length</span>; i++) &#123;<br>    imgs[i].<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span> = imgSrc[i];<br>&#125;<br><br><span class="hljs-keyword">let</span> len = imgs.<span class="hljs-property">length</span>;<br><br><span class="hljs-keyword">const</span> lazyLoad = (<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> deleteIndex = [];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;imgs.<span class="hljs-property">length</span>; i++) &#123;<br>            <span class="hljs-keyword">if</span>(imgs[i].<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">top</span> &lt; <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>) &#123;<br>                imgs[i].<span class="hljs-property">src</span> = imgs[i].<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span>;<br>                deleteIndex.<span class="hljs-title function_">push</span>(i)<br>            &#125;<br>        &#125;<br>        imgs = imgs.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> !deleteIndex.<span class="hljs-title function_">includes</span>(index)<br>        &#125;)<br>        <span class="hljs-keyword">if</span>(imgs.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;scroll&#x27;</span>, lazyLoad);<br>        &#125;<br>    &#125;<br>&#125;)()<br><br><span class="hljs-title function_">lazyLoad</span>();<br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;scroll&#x27;</span>, lazyLoad);<br></code></pre></td></tr></table></figure></code></pre><h4 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&#123;<br>    <span class="hljs-title function_">contructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stack</span> = [];<br>    &#125;<br><br>    <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">stack</span>.<span class="hljs-title function_">join</span>();<br>    &#125;<br><br>    <span class="hljs-title function_">push</span>(<span class="hljs-params">val</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stack</span>.<span class="hljs-title function_">push</span>(val);<br>    &#125;<br><br>    <span class="hljs-title function_">pop</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">stack</span>.<span class="hljs-title function_">pop</span>();<br>    &#125;<br><br>    <span class="hljs-title function_">top</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">stack</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">stack</span>.<span class="hljs-property">length</span>-<span class="hljs-number">1</span>];<br>    &#125;<br><br>    <span class="hljs-title function_">size</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">stack</span>.<span class="hljs-property">length</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Queue</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">size = <span class="hljs-number">10</span></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> = size;<br>    &#125;<br><br>    <span class="hljs-title function_">enQueue</span>(<span class="hljs-params">val</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFull</span>()) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">deQueue</span>();<br>        &#125;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(val)<br>    &#125;<br><br>    <span class="hljs-title function_">deQueue</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">shift</span>();<br>    &#125;<br><br>    <span class="hljs-title function_">isFull</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>;<br>    &#125;<br><br>    <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">join</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">&#123;val, next&#125;</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span> = val;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">next</span> = next;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> _head = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;_head&#x27;</span>);<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NodeList</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// 初始一个头节点，不可访问，不能找到</span><br>        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, &#123;<br>            [_head]:&#123;<br>                <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-attr">value</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(&#123;<span class="hljs-attr">val</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">next</span>: <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-attr">enumerable</span>:<span class="hljs-literal">false</span>,<br>                <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span><br>            &#125;<br>        &#125;)<br>    &#125;<br><br>    <span class="hljs-comment">// 插入节点</span><br>    <span class="hljs-title function_">insert</span>(<span class="hljs-params">val, index</span>) &#123;<br>        <span class="hljs-keyword">let</span> node = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(&#123;<span class="hljs-attr">val</span>: val, <span class="hljs-attr">next</span>: <span class="hljs-literal">null</span>&#125;)<br>        <span class="hljs-comment">// 如果没有头节点，插入的第一个节点就是头节点</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable language_">this</span>[_head].<span class="hljs-property">val</span>) &#123;<br>            <span class="hljs-variable language_">this</span>[_head] = node;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-comment">// 如果index没有值，插入到最后</span><br>        <span class="hljs-keyword">if</span>(!index) &#123;<br>            <span class="hljs-keyword">let</span> lastNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">find</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">size</span>()-<span class="hljs-number">1</span>);<br>            lastNode.<span class="hljs-property">next</span> = node;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// 如果index为0，替换头节点</span><br>        <span class="hljs-keyword">if</span>(index === <span class="hljs-number">0</span>) &#123;<br>            node.<span class="hljs-property">next</span> = <span class="hljs-variable language_">this</span>[_head];<br>            <span class="hljs-variable language_">this</span>[_head] = node;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-comment">// 其余正常的，先获取上一个节点</span><br>        <span class="hljs-keyword">let</span> prevNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">find</span>(index-<span class="hljs-number">1</span>);<br>        node.<span class="hljs-property">next</span> = prevNode.<span class="hljs-property">next</span>;<br>        prevNode.<span class="hljs-property">next</span> = node;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 判断链表长度</span><br>    <span class="hljs-title function_">size</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> n = <span class="hljs-variable language_">this</span>[_head];<br>        <span class="hljs-keyword">while</span>(n) &#123;<br>            n = n.<span class="hljs-property">next</span>;<br>            i++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> i;<br>    &#125;<br><br>    <span class="hljs-comment">// 将链表转成字符串形式</span><br>    <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> n = <span class="hljs-variable language_">this</span>[_head];<br>        <span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">while</span>(n)&#123;<br>            str += n.<span class="hljs-property">val</span>;<br>            <span class="hljs-keyword">if</span>(n.<span class="hljs-property">next</span>) &#123;<br>                str += <span class="hljs-string">&quot;, &quot;</span><br>            &#125;<br>            n = n.<span class="hljs-property">next</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> str;<br>    &#125;<br><br>    <span class="hljs-comment">// 获取节点</span><br>    <span class="hljs-title function_">find</span>(<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-keyword">let</span> n = <span class="hljs-variable language_">this</span>[_head];<br>        <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span>(i !== index) &#123;<br>            i++;<br>            n = n.<span class="hljs-property">next</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;<br><br>    <span class="hljs-comment">// 转为数组</span><br>    <span class="hljs-title function_">toArray</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> n = <span class="hljs-variable language_">this</span>[_head];<br>        <span class="hljs-keyword">let</span> arr = [];<br>        <span class="hljs-keyword">while</span>(n) &#123;<br>            arr.<span class="hljs-title function_">push</span>(n.<span class="hljs-property">val</span>);<br>            n = n.<span class="hljs-property">next</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> arr;<br>    &#125;<br><br>    <span class="hljs-comment">// 更新</span><br>    <span class="hljs-title function_">update</span>(<span class="hljs-params">val, index</span>) &#123;<br>        <span class="hljs-keyword">let</span> node = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">find</span>(index);<br>        node.<span class="hljs-property">val</span> = val;<br>    &#125;<br><br>    <span class="hljs-comment">// 删除</span><br>    <span class="hljs-title function_">deleteByIndex</span>(<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-keyword">let</span> node = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">find</span>(index);<br><br>        <span class="hljs-comment">// 如果删除的是头节点</span><br>        <span class="hljs-keyword">if</span>(index === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-variable language_">this</span>[_head] = node.<span class="hljs-property">next</span>;<br>            node.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">let</span> prevNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">find</span>(index-<span class="hljs-number">1</span>);<br>        prevNode.<span class="hljs-property">next</span> = node.<span class="hljs-property">next</span>;<br>        node.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="树"><a href="#树" class="headerlink" title="树"></a>树</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Tree</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">val, left, right</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span> = val;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">left</span> = left;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">right</span> = right;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tree</span>(<span class="hljs-number">1</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br><span class="hljs-keyword">let</span> node_1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tree</span>(<span class="hljs-number">2</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br><span class="hljs-keyword">let</span> node_2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tree</span>(<span class="hljs-number">3</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br><span class="hljs-keyword">let</span> node_3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tree</span>(<span class="hljs-number">4</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br><span class="hljs-keyword">let</span> node_4 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tree</span>(<span class="hljs-number">5</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br><span class="hljs-keyword">let</span> node_5 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tree</span>(<span class="hljs-number">6</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br><span class="hljs-keyword">let</span> node_6 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tree</span>(<span class="hljs-number">7</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>head.<span class="hljs-property">left</span> = node_1;<br>head.<span class="hljs-property">right</span> = node_2;<br>node_1.<span class="hljs-property">left</span> = node_3;<br>node_1.<span class="hljs-property">right</span> = node_4;<br>node_2.<span class="hljs-property">left</span> = node_5;<br>node_2.<span class="hljs-property">right</span> = node_6;<br>node_3.<span class="hljs-property">left</span> = node_7;<br><br><br><span class="hljs-comment">// 实现树的中序遍历</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">inOrder</span>(<span class="hljs-params">head</span>) &#123;<br>    <span class="hljs-keyword">if</span>(!head) <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">let</span> stack = [head];<br>    <span class="hljs-keyword">let</span> n = head.<span class="hljs-property">left</span>;<br>    <span class="hljs-keyword">while</span>(stack.<span class="hljs-property">length</span>) &#123;<br>        <span class="hljs-keyword">while</span>(n) &#123;  <span class="hljs-comment">// 将n变为最左边的值</span><br>            stack.<span class="hljs-title function_">push</span>(n);<br>            n = n.<span class="hljs-property">left</span>;<br>        &#125;<br>        <span class="hljs-keyword">let</span> node = stack.<span class="hljs-title function_">pop</span>();<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(node.<span class="hljs-property">val</span>);<br>        <span class="hljs-keyword">if</span> (node.<span class="hljs-property">right</span>) &#123;<br>            stack.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">right</span>);<br>            n = node.<span class="hljs-property">right</span>.<span class="hljs-property">left</span>;<br>        &#125;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 实现树的先序遍历</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">prevOrder</span>(<span class="hljs-params">head</span>) &#123;<br>    <span class="hljs-keyword">if</span>(!head) <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">let</span> stack = [head];<br>    <span class="hljs-keyword">while</span>(stack.<span class="hljs-property">length</span>) &#123;<br>        <span class="hljs-keyword">let</span> n = stack.<span class="hljs-title function_">pop</span>();<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n.<span class="hljs-property">val</span>);<br>        n.<span class="hljs-property">right</span> &amp;&amp; stack.<span class="hljs-title function_">push</span>(n.<span class="hljs-property">right</span>);<br>        n.<span class="hljs-property">left</span> &amp;&amp; stack.<span class="hljs-title function_">push</span>(n.<span class="hljs-property">left</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 实现树的层序遍历</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">order</span>(<span class="hljs-params">head</span>) &#123;<br>    <span class="hljs-keyword">if</span>(!head) <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">let</span> queue = [head];<br>    <span class="hljs-keyword">while</span>(queue.<span class="hljs-property">length</span>) &#123;<br>        <span class="hljs-keyword">let</span> n = queue.<span class="hljs-title function_">shift</span>();<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n.<span class="hljs-property">val</span>);<br>        n.<span class="hljs-property">left</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(n.<span class="hljs-property">left</span>);<br>        n.<span class="hljs-property">right</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(n.<span class="hljs-property">right</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>算法</title>
    <link href="/2024/06/09/%E7%AE%97%E6%B3%95/"/>
    <url>/2024/06/09/%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><h4 id="实现千位分隔符"><a href="#实现千位分隔符" class="headerlink" title="实现千位分隔符"></a>实现千位分隔符</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">numberWithCommas</span>(<span class="hljs-params">x</span>) &#123;<br>  x = x.<span class="hljs-title function_">toString</span>();<br>  <span class="hljs-keyword">var</span> pattern = <span class="hljs-regexp">/(-?\d+)(\d&#123;3&#125;)/</span>;<br>  <span class="hljs-keyword">while</span> (pattern.<span class="hljs-title function_">test</span>(x)) x = x.<span class="hljs-title function_">replace</span>(pattern, <span class="hljs-string">&quot;$1,$2&quot;</span>);<br>  <span class="hljs-keyword">return</span> x;<br>&#125;<br><span class="hljs-title function_">numberWithCommas</span>(<span class="hljs-number">12312124545</span>); <span class="hljs-comment">//&#x27;12,312,124,545&#x27;</span><br><span class="hljs-title function_">numberWithCommas</span>(<span class="hljs-number">123121245.45</span>); <span class="hljs-comment">//&#x27;123,121,245.45&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">bubbleSort</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j=<span class="hljs-number">1</span>; j&lt;arr.<span class="hljs-property">length</span>-i; j++) &#123;<br>            <span class="hljs-keyword">if</span>(arr[j] &lt; arr[j-<span class="hljs-number">1</span>]) &#123;<br>                <span class="hljs-keyword">let</span> temp = arr[j];<br>                arr[j] = arr[j-<span class="hljs-number">1</span>];<br>                arr[j-<span class="hljs-number">1</span>] = temp;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> arr;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">bubbleSort</span>([<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure></code></pre><h4 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">selectionSort</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">let</span> min = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j=i+<span class="hljs-number">1</span>; j&lt;arr.<span class="hljs-property">length</span>; j++) &#123;<br>            <span class="hljs-keyword">if</span>(arr[j] &lt; arr[min]) &#123;<br>                min = j;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">let</span> temp = arr[i];<br>        arr[i] = arr[min];<br>        arr[min] = temp;<br>    &#125;<br>    <span class="hljs-keyword">return</span> arr;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">selectionSort</span>([<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure></code></pre><h4 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">insertionSort</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">1</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">let</span> current = arr[i];<br>        <span class="hljs-keyword">let</span> j = i - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span>(j &gt;= <span class="hljs-number">0</span> &amp;&amp; arr[j] &gt; current) &#123;<br>            arr[j+<span class="hljs-number">1</span>] = arr[j];<br>            j--;<br>        &#125;<br>        arr[j+<span class="hljs-number">1</span>] = current;<br>    &#125;<br>    <span class="hljs-keyword">return</span> arr;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">insertionSort</span>([<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure></code></pre><h4 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">quickSort</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">if</span>(arr.<span class="hljs-property">length</span> &lt;= <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">return</span> arr;<br>    &#125;<br>    <span class="hljs-keyword">let</span> pivotIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(arr.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">let</span> pivot = arr.<span class="hljs-title function_">splice</span>(pivotIndex, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">let</span> left = [];<br>    <span class="hljs-keyword">let</span> right = [];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span>(arr[i] &lt; pivot) &#123;<br>            left.<span class="hljs-title function_">push</span>(arr[i]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            right.<span class="hljs-title function_">push</span>(arr[i]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> [...<span class="hljs-title function_">quickSort</span>(left), pivot, ...<span class="hljs-title function_">quickSort</span>(right)];<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">quickSort</span>([<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure></code></pre><h4 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeSort</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">if</span>(arr.<span class="hljs-property">length</span> &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> arr;<br>    <span class="hljs-keyword">let</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(arr.<span class="hljs-property">length</span>/<span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">let</span> left = arr.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, mid);<br>    <span class="hljs-keyword">let</span> right = arr.<span class="hljs-title function_">slice</span>(mid);<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(<span class="hljs-title function_">mergeSort</span>(left), <span class="hljs-title function_">mergeSort</span>(right));<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">left, right</span>) &#123;<br>    <span class="hljs-keyword">let</span> result = [];<br>    <span class="hljs-keyword">while</span>(left.<span class="hljs-property">length</span> &amp;&amp; right.<span class="hljs-property">length</span>) &#123;<br>        <span class="hljs-keyword">if</span>(left[<span class="hljs-number">0</span>] &lt; right[<span class="hljs-number">0</span>]) &#123;<br>            result.<span class="hljs-title function_">push</span>(left.<span class="hljs-title function_">shift</span>())<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            result.<span class="hljs-title function_">push</span>(right.<span class="hljs-title function_">shift</span>())<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(left.<span class="hljs-property">length</span>) &#123;<br>        result.<span class="hljs-title function_">push</span>(left.<span class="hljs-title function_">shift</span>())<br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(right.<span class="hljs-property">length</span>) &#123;<br>        result.<span class="hljs-title function_">push</span>(right.<span class="hljs-title function_">shift</span>())<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">bSearch</span>(<span class="hljs-params">arr, target</span>) &#123;<br>  <span class="hljs-keyword">let</span> low = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">let</span> high = arr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>    <span class="hljs-keyword">let</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((low + high) / <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">if</span> (arr[mid] === target) <span class="hljs-keyword">return</span> mid;<br>    <span class="hljs-keyword">if</span> (arr[mid] &gt; target) &#123;<br>      high = mid - <span class="hljs-number">1</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      low = mid + <span class="hljs-number">1</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="求数组的交集并集差集"><a href="#求数组的交集并集差集" class="headerlink" title="求数组的交集并集差集"></a>求数组的交集并集差集</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> nums1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br><span class="hljs-keyword">let</span> nums2 = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><br><span class="hljs-comment">// 求交集</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">intersection</span>(<span class="hljs-params">nums1, nums2</span>) &#123;<br>  <span class="hljs-keyword">return</span> nums1.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(nums2).<span class="hljs-title function_">has</span>(item);<br>  &#125;);<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">intersection</span>(nums1, nums2));<br><br><span class="hljs-comment">// 求并集</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">sumSet</span>(<span class="hljs-params">nums1, nums2</span>) &#123;<br>  <span class="hljs-keyword">return</span> [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(nums1), ...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(nums2)])];<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">sumSet</span>(nums1, nums2));<br><br><span class="hljs-comment">// 求差集</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">differenceSet</span>(<span class="hljs-params">nums1, nums2</span>) &#123;<br>  <span class="hljs-keyword">return</span> nums1<br>    .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> !<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(nums2).<span class="hljs-title function_">has</span>(item))<br>    .<span class="hljs-title function_">concat</span>(nums2.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> !<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(nums1).<span class="hljs-title function_">has</span>(item)));<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">differenceSet</span>(nums1, nums2));<br></code></pre></td></tr></table></figure><h4 id="实现方法rotate-arr-k-，第一个参数为数组，第二个参数为非负数，将数组向右移动-k-步"><a href="#实现方法rotate-arr-k-，第一个参数为数组，第二个参数为非负数，将数组向右移动-k-步" class="headerlink" title="实现方法rotate(arr, k)，第一个参数为数组，第二个参数为非负数，将数组向右移动 k 步"></a>实现方法<code>rotate(arr, k)</code>，第一个参数为数组，第二个参数为非负数，将数组向右移动 k 步</h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">rotate</span>(<span class="hljs-params">arr, num</span>) &#123;<br>    <span class="hljs-keyword">let</span> len = arr.<span class="hljs-property">length</span>;<br>    num = num%len;<br>    <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">slice</span>(num).<span class="hljs-title function_">concat</span>(arr.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, num));<br>&#125;<br><br><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];<br><span class="hljs-title function_">rotate</span>(arr, <span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure></code></pre><h4 id="给定一个字符串-str，返回字符串中字母顺序最大的并且同时在字符串中出现大写和小写的字母，不存在返回"><a href="#给定一个字符串-str，返回字符串中字母顺序最大的并且同时在字符串中出现大写和小写的字母，不存在返回" class="headerlink" title="给定一个字符串 str，返回字符串中字母顺序最大的并且同时在字符串中出现大写和小写的字母，不存在返回~"></a>给定一个字符串 str，返回字符串中字母顺序最大的并且同时在字符串中出现大写和小写的字母，不存在返回<code>~</code></h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">printBigLetter</span>(<span class="hljs-params">str</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>    arr.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> b.<span class="hljs-title function_">charCodeAt</span>() - a.<span class="hljs-title function_">charCodeAt</span>()&#125;)<br>    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(arr[index].<span class="hljs-title function_">charCodeAt</span>() &gt; <span class="hljs-number">90</span>) &#123;<br>        <span class="hljs-comment">// 找大写，如果arr[i].charCodeAt()&lt;90就不再循环</span><br>        <span class="hljs-keyword">if</span>(arr.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>).<span class="hljs-title function_">lastIndexOf</span>(arr[index].<span class="hljs-title function_">toUpperCase</span>()) !== -<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">return</span> arr[index].<span class="hljs-title function_">toUpperCase</span>();<br>        &#125;<br>        index++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;~&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure></code></pre><h4 id="回文括号-，"><a href="#回文括号-，" class="headerlink" title="回文括号 {[({[]})]}，[{)]"></a>回文括号 <code>&#123;[(&#123;[]&#125;)]&#125;</code>，<code>[&#123;)]</code></h4><pre><code class="hljs"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">palindromeBrackets</span>(<span class="hljs-params">str</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>    <span class="hljs-keyword">let</span> stack = [];<br>    <span class="hljs-keyword">let</span> obj = &#123;<span class="hljs-string">&#x27;(&#x27;</span> : <span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span> : <span class="hljs-string">&#x27;&#125;&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span> : <span class="hljs-string">&#x27;]&#x27;</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span>(arr[i] === <span class="hljs-string">&#x27;(&#x27;</span>) &#123;stack.<span class="hljs-title function_">push</span>(obj[arr[i]])&#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arr[i] === <span class="hljs-string">&#x27;&#123;&#x27;</span>) &#123;stack.<span class="hljs-title function_">push</span>(obj[arr[i]])&#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arr[i] === <span class="hljs-string">&#x27;[&#x27;</span>) &#123;stack.<span class="hljs-title function_">push</span>(obj[arr[i]])&#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arr[i] !== stack[stack.<span class="hljs-property">length</span>-<span class="hljs-number">1</span>] || stack.<span class="hljs-property">length</span>===<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">else</span> stack.<span class="hljs-title function_">pop</span>();<br>    &#125;<br>    <span class="hljs-comment">// 如果栈中还有值，说明左边括号多，返回false</span><br>    <span class="hljs-keyword">if</span>(stack.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>设计模式</title>
    <link href="/2024/06/09/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <url>/2024/06/09/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><h3 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h3><ul><li>保证一个类仅有一个实例，并提供一个访问它的全局访问点</li><li>实现：<ul><li>私有化构造函数</li><li>静态化方法，返回实例</li><li>私有化静态变量</li><li>私有化静态方法</li><li>静态方法中判断实例是否存在，存在则返回，不存在则创建</li></ul></li><li>应用场景：<ul><li>弹框</li><li>登录框</li><li>购物车</li><li>全局缓存</li><li>全局唯一的数据源</li></ul></li><li>优点：<ul><li>只有一个实例，减少内存开销</li><li>避免对资源的多重占用</li><li>设置全局访问点，严格控制访问</li></ul></li><li>缺点：<ul><li>没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化</li><li>滥用单例将带来一些负面问题，如为了节省资源将数据库连接池对象设计为的单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出</li></ul></li></ul><h5 id="单例模式实现弹框-TS-实现"><a href="#单例模式实现弹框-TS-实现" class="headerlink" title="单例模式实现弹框 - TS 实现"></a>单例模式实现弹框 - TS 实现</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Login</span> = (<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> div = <span class="hljs-literal">null</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (!div) &#123;<br>      div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);<br>      div.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`&lt;div class=&quot;msk&quot;&gt;</span><br><span class="hljs-string">                    &lt;button id=&quot;close&quot;&gt;点击关闭&lt;/button&gt;</span><br><span class="hljs-string">                    &lt;h2&gt;标题&lt;/h2&gt;</span><br><span class="hljs-string">                    &lt;p&gt;内容&lt;/p&gt;</span><br><span class="hljs-string">                    &lt;/div&gt;`</span>;<br>      div.<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">&quot;#eee&quot;</span>;<br>      div.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&quot;300px&quot;</span>;<br>      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(div);<br>    &#125;<br>    <span class="hljs-keyword">return</span> div;<br>  &#125;;<br>&#125;)();<br><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;btn&quot;</span>).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> login = <span class="hljs-title class_">Login</span>();<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(login);<br>  login.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;block&quot;</span>;<br>  <span class="hljs-title function_">close</span>();<br>&#125;;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">close</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;close&quot;</span>).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> login = <span class="hljs-title class_">Login</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(login);<br>    login.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;none&quot;</span>;<br>  &#125;;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="发布订阅模式"><a href="#发布订阅模式" class="headerlink" title="发布订阅模式"></a>发布订阅模式</h3><ul><li>定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知</li><li>实现：<ul><li>创建一个事件中心，用来存放事件和事件监听器</li><li>订阅事件，将事件监听器添加到事件中心</li><li>发布事件，触发事件中心中的事件监听器</li></ul></li><li>应用场景：<ul><li>网页事件</li><li>用户行为</li><li>网页通知</li><li>跨窗口通信</li><li>异步编程</li></ul></li><li>优点：<ul><li>支持简单的广播通信，自动通知所有已经订阅过的对象</li><li>目标对象与观察者之间的抽象耦合关系能够单独扩展以及重用</li></ul></li><li>缺点：<ul><li>创建订阅者需要消耗一定的时间和内存</li><li>虽然可以弱化对象之间的联系，但是过度使用的话，会导致程序难以跟踪维护和理解</li></ul></li></ul><h5 id="发布订阅模式实现-TS-实现"><a href="#发布订阅模式实现-TS-实现" class="headerlink" title="发布订阅模式实现 - TS 实现"></a>发布订阅模式实现 - TS 实现</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = &#123;&#125;; <span class="hljs-comment">//实践中心 &#123;type:[]&#125;</span><br>  &#125;<br>  $on(<span class="hljs-keyword">type</span>, fn) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>]) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>] = [];<br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>].<span class="hljs-title function_">push</span>(fn);<br>  &#125;<br>  $emit(<span class="hljs-keyword">type</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>]) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>      <span class="hljs-title function_">item</span>();<br>    &#125;);<br>  &#125;<br>  $off(<span class="hljs-keyword">type</span>, fn) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>]) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span> (!fn) &#123;<br>      <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>];<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>[<span class="hljs-keyword">type</span>].<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> item !== fn;<br>    &#125;);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
